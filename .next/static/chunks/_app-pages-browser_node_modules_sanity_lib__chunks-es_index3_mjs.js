"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_sanity_lib__chunks-es_index3_mjs"],{

/***/ "(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js":
/*!********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pairwise: function() { return /* binding */ pairwise; }\n/* harmony export */ });\n/* harmony import */ var _util_lift__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/lift */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/util/lift.js\");\n/* harmony import */ var _OperatorSubscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OperatorSubscriber */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js\");\n\n\nfunction pairwise() {\n    return (0,_util_lift__WEBPACK_IMPORTED_MODULE_0__.operate)(function(source, subscriber) {\n        var prev;\n        var hasPrev = false;\n        source.subscribe((0,_OperatorSubscriber__WEBPACK_IMPORTED_MODULE_1__.createOperatorSubscriber)(subscriber, function(value) {\n            var p = prev;\n            prev = value;\n            hasPrev && subscriber.next([\n                p,\n                value\n            ]);\n            hasPrev = true;\n        }));\n    });\n} //# sourceMappingURL=pairwise.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvcGFpcndpc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ3VDO0FBQ3lCO0FBNkMxRCxTQUFVRTtJQUNkLE9BQU9GLG1EQUFBQSxDQUFRLFNBQUNHLE1BQU0sRUFBRUMsVUFBVTtRQUNoQyxJQUFJQztRQUNKLElBQUlDLFVBQVU7UUFDZEgsT0FBT0ksU0FBUyxDQUNkTiw2RUFBQUEsQ0FBeUJHLFlBQVksU0FBQ0ksS0FBSztZQUN6QyxJQUFNQyxJQUFJSjtZQUNWQSxPQUFPRztZQUNQRixXQUFXRixXQUFXTSxJQUFJLENBQUM7Z0JBQUNEO2dCQUFHRDthQUFNO1lBQ3JDRixVQUFVO1FBQ1o7SUFFSjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uLi8uLi8uLi9zcmMvaW50ZXJuYWwvb3BlcmF0b3JzL3BhaXJ3aXNlLnRzPzJkNzEiXSwibmFtZXMiOlsib3BlcmF0ZSIsImNyZWF0ZU9wZXJhdG9yU3Vic2NyaWJlciIsInBhaXJ3aXNlIiwic291cmNlIiwic3Vic2NyaWJlciIsInByZXYiLCJoYXNQcmV2Iiwic3Vic2NyaWJlIiwidmFsdWUiLCJwIiwibmV4dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/index3.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/sanity/lib/_chunks-es/index3.mjs ***!
  \*******************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ StructureToolBoundary; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var sanity__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! sanity */ \"(app-pages-browser)/./node_modules/sanity/lib/index.mjs\");\n/* harmony import */ var _generate_help_url_esm_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./generate-help-url.esm.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/generate-help-url.esm.mjs\");\n/* harmony import */ var _pane_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./pane.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/pane.mjs\");\n/* harmony import */ var sanity_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! sanity/router */ \"(app-pages-browser)/./node_modules/sanity/lib/router.mjs\");\n/* harmony import */ var lodash_omit_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/omit.js */ \"(app-pages-browser)/./node_modules/lodash/omit.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/util/isObservable.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/from.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/of.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/concat.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/never.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! nanoid */ \"(app-pages-browser)/./node_modules/nanoid/index.browser.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/publishReplay.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/refCount.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/map.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/startWith.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/scan.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js\");\n/* harmony import */ var _sanity_uuid__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @sanity/uuid */ \"(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! @sanity/icons */ \"(app-pages-browser)/./node_modules/sanity/node_modules/@sanity/icons/dist/index.js\");\n/* harmony import */ var _sanity_ui__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! @sanity/ui */ \"(app-pages-browser)/./node_modules/@sanity/ui/dist/index.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! styled-components */ \"(app-pages-browser)/./node_modules/styled-components/dist/styled-components.browser.esm.js\");\n/* harmony import */ var is_hotkey_esm__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! is-hotkey-esm */ \"(app-pages-browser)/./node_modules/is-hotkey-esm/dist/index.js\");\n/* harmony import */ var lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/isEqual.js */ \"(app-pages-browser)/./node_modules/lodash/isEqual.js\");\n/* harmony import */ var _sanity_util_paths__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/util/paths */ \"(app-pages-browser)/./node_modules/@sanity/util/lib/paths.mjs\");\n/* harmony import */ var sanity_singletons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! sanity/_singletons */ \"(app-pages-browser)/./node_modules/sanity/lib/_singletons.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst emptyArray = [];\nfunction PaneRouterProvider(props) {\n  const { children, flatIndex, index, params, payload, siblingIndex } = props, { navigate, navigateIntent, resolvePathFromState } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)(), routerState = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouterState)(), { panes, expand } = (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.usePaneLayout)(), routerPaneGroups = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => routerState?.panes || emptyArray,\n    [routerState?.panes]\n  ), lastPane = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => panes?.[panes.length - 2], [panes]), groupIndex = index - 1, createNextRouterState = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (modifier) => {\n      const currentGroup = routerPaneGroups[groupIndex] || [], currentItem = currentGroup[siblingIndex], nextGroup = modifier(currentGroup, currentItem), nextPanes = [\n        ...routerPaneGroups.slice(0, groupIndex),\n        nextGroup,\n        ...routerPaneGroups.slice(groupIndex + 1)\n      ];\n      return { ...routerState || {}, panes: nextPanes };\n    },\n    [groupIndex, routerPaneGroups, routerState, siblingIndex]\n  ), modifyCurrentGroup = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (modifier) => {\n      const nextRouterState = createNextRouterState(modifier);\n      return setTimeout(() => navigate(nextRouterState), 0), nextRouterState;\n    },\n    [createNextRouterState, navigate]\n  ), createPathWithParams = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nextParams) => {\n      const nextRouterState = createNextRouterState((siblings, item) => [\n        ...siblings.slice(0, siblingIndex),\n        { ...item, params: nextParams },\n        ...siblings.slice(siblingIndex + 1)\n      ]);\n      return resolvePathFromState(nextRouterState);\n    },\n    [createNextRouterState, resolvePathFromState, siblingIndex]\n  ), setPayload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nextPayload) => {\n      modifyCurrentGroup((siblings, item) => [\n        ...siblings.slice(0, siblingIndex),\n        { ...item, payload: nextPayload },\n        ...siblings.slice(siblingIndex + 1)\n      ]);\n    },\n    [modifyCurrentGroup, siblingIndex]\n  ), setParams = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    (nextParams) => {\n      modifyCurrentGroup((siblings, item) => [\n        ...siblings.slice(0, siblingIndex),\n        { ...item, params: nextParams },\n        ...siblings.slice(siblingIndex + 1)\n      ]);\n    },\n    [modifyCurrentGroup, siblingIndex]\n  ), handleEditReference = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(\n    ({ id, parentRefPath, type, template }) => {\n      navigate({\n        panes: [\n          ...routerPaneGroups.slice(0, groupIndex + 1),\n          [\n            {\n              id,\n              params: { template: template.id, parentRefPath: (0,_sanity_util_paths__WEBPACK_IMPORTED_MODULE_6__.toString)(parentRefPath), type },\n              payload: template.params\n            }\n          ]\n        ]\n      });\n    },\n    [groupIndex, navigate, routerPaneGroups]\n  ), ctx = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => ({\n      // Zero-based index (position) of pane, visually\n      index: flatIndex,\n      // Zero-based index of pane group (within URL structure)\n      groupIndex,\n      // Zero-based index of pane within sibling group\n      siblingIndex,\n      // Payload of the current pane\n      payload,\n      // Params of the current pane\n      params,\n      // Whether or not the pane has any siblings (within the same group)\n      hasGroupSiblings: routerPaneGroups[groupIndex] ? routerPaneGroups[groupIndex].length > 1 : !1,\n      // The length of the current group\n      groupLength: routerPaneGroups[groupIndex] ? routerPaneGroups[groupIndex].length : 0,\n      // Current router state for the \"panes\" property\n      routerPanesState: routerPaneGroups,\n      // Curried StateLink that passes the correct state automatically\n      ChildLink: _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.ChildLink,\n      // Curried StateLink that pops off the last pane group\n      // Only pass if this is not the first pane\n      BackLink: flatIndex ? _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.BackLink : void 0,\n      // A specialized `ChildLink` that takes in the needed props to open a\n      // referenced document to the right\n      ReferenceChildLink: _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.ReferenceChildLink,\n      // Similar to `ReferenceChildLink` expect without the wrapping component\n      handleEditReference,\n      // Curried StateLink that passed the correct state, but merges params/payload\n      ParameterizedLink: _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.ParameterizedLink,\n      // Replaces the current pane with a new one\n      replaceCurrent: (opts = {}) => {\n        modifyCurrentGroup(() => [\n          { id: opts.id || \"\", payload: opts.payload, params: opts.params || {} }\n        ]);\n      },\n      // Removes the current pane from the group\n      closeCurrent: () => {\n        modifyCurrentGroup(\n          (siblings, item) => siblings.length > 1 ? siblings.filter((sibling) => sibling !== item) : siblings\n        );\n      },\n      // Removes all panes to the right including current\n      closeCurrentAndAfter: (expandLast = !0) => {\n        expandLast && lastPane && expand(lastPane.element), navigate({\n          panes: [...routerPaneGroups.slice(0, groupIndex)]\n        });\n      },\n      // Duplicate the current pane, with optional overrides for payload, parameters\n      duplicateCurrent: (options) => {\n        modifyCurrentGroup((siblings, item) => {\n          const duplicatedItem = {\n            ...item,\n            payload: options?.payload || item.payload,\n            params: options?.params || item.params\n          };\n          return [\n            ...siblings.slice(0, siblingIndex),\n            duplicatedItem,\n            ...siblings.slice(siblingIndex)\n          ];\n        });\n      },\n      // Set the view for the current pane\n      setView: (viewId) => {\n        const restParams = lodash_omit_js__WEBPACK_IMPORTED_MODULE_2__(params, \"view\");\n        return setParams(viewId ? { ...restParams, view: viewId } : restParams);\n      },\n      // Set the parameters for the current pane\n      setParams,\n      // Set the payload for the current pane\n      setPayload,\n      // A function that returns a path with the given parameters\n      createPathWithParams,\n      // Proxied navigation to a given intent. Consider just exposing `router` instead?\n      navigateIntent\n    }),\n    [\n      flatIndex,\n      groupIndex,\n      siblingIndex,\n      payload,\n      params,\n      routerPaneGroups,\n      handleEditReference,\n      setParams,\n      setPayload,\n      createPathWithParams,\n      navigateIntent,\n      modifyCurrentGroup,\n      lastPane,\n      navigate,\n      expand\n    ]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity_singletons__WEBPACK_IMPORTED_MODULE_7__.PaneRouterContext.Provider, { value: ctx, children });\n}\nclass PaneResolutionError extends Error {\n  cause;\n  context;\n  helpId;\n  constructor({ message, context, helpId, cause }) {\n    super(message), this.name = \"PaneResolutionError\", this.context = context, this.helpId = helpId, this.cause = cause;\n  }\n}\nconst randomIdCache = /* @__PURE__ */ new WeakMap();\nfunction assignId(obj) {\n  const cachedValue = randomIdCache.get(obj);\n  if (cachedValue) return cachedValue;\n  const id = (0,nanoid__WEBPACK_IMPORTED_MODULE_8__.nanoid)();\n  return randomIdCache.set(obj, id), id;\n}\nconst isPromise = (thing) => !!thing && typeof thing?.then == \"function\", isSerializable = (thing) => (0,sanity__WEBPACK_IMPORTED_MODULE_9__.isRecord)(thing) ? typeof thing.serialize == \"function\" : !1, rethrowWithPaneResolutionErrors = (next) => (unresolvedPane, context, flatIndex) => {\n  try {\n    return next(unresolvedPane, context, flatIndex);\n  } catch (e) {\n    throw e instanceof PaneResolutionError ? e : new PaneResolutionError({\n      message: typeof e?.message == \"string\" ? e.message : \"\",\n      context,\n      cause: e\n    });\n  }\n}, wrapWithPublishReplay = (next) => (...args) => next(...args).pipe(\n  // need to add publishReplay + refCount to ensure new subscribers always\n  // get an emission. without this, memoized observables may get stuck\n  // waiting for their first emissions resulting in a loading pane\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.publishReplay)(1),\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.refCount)()\n);\nfunction createPaneResolver(middleware) {\n  const resolvePane = rethrowWithPaneResolutionErrors(\n    wrapWithPublishReplay(\n      middleware((unresolvedPane, context, flatIndex) => {\n        if (!unresolvedPane)\n          throw new PaneResolutionError({\n            message: \"Pane returned no child\",\n            context,\n            helpId: \"structure-item-returned-no-child\"\n          });\n        return isPromise(unresolvedPane) || (0,rxjs__WEBPACK_IMPORTED_MODULE_12__.isObservable)(unresolvedPane) ? (0,rxjs__WEBPACK_IMPORTED_MODULE_13__.from)(unresolvedPane).pipe(\n          (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.switchMap)((result) => resolvePane(result, context, flatIndex))\n        ) : isSerializable(unresolvedPane) ? resolvePane(unresolvedPane.serialize(context), context, flatIndex) : typeof unresolvedPane == \"function\" ? resolvePane(unresolvedPane(context.id, context), context, flatIndex) : (0,rxjs__WEBPACK_IMPORTED_MODULE_15__.of)(unresolvedPane);\n      })\n    )\n  );\n  return resolvePane;\n}\nconst bindCache = /* @__PURE__ */ new WeakMap();\nfunction memoBind(obj, methodKey) {\n  const boundMethods = bindCache.get(obj) || /* @__PURE__ */ new Map();\n  if (boundMethods) {\n    const bound2 = boundMethods.get(methodKey);\n    if (bound2) return bound2;\n  }\n  const method = obj[methodKey];\n  if (typeof method != \"function\")\n    throw new Error(\n      `Expected property \\`${methodKey}\\` to be a function but got ${typeof method} instead.`\n    );\n  const bound = method.bind(obj);\n  return boundMethods.set(methodKey, bound), bindCache.set(obj, boundMethods), bound;\n}\nasync function resolveIntent(options) {\n  const resolvedPaneCache = /* @__PURE__ */ new Map(), resolvePane = createPaneResolver((nextFn) => (unresolvedPane, context, flatIndex) => {\n    const key = unresolvedPane && `${assignId(unresolvedPane)}-${context.path.join(\"__\")}`, cachedResolvedPane = key && resolvedPaneCache.get(key);\n    if (cachedResolvedPane) return cachedResolvedPane;\n    const result = nextFn(unresolvedPane, context, flatIndex);\n    return key && resolvedPaneCache.set(key, result), result;\n  }), fallbackEditorPanes = [\n    [\n      {\n        id: `__edit__${options.params.id}`,\n        params: { ...lodash_omit_js__WEBPACK_IMPORTED_MODULE_2__(options.params, [\"id\"]), type: options.params.type },\n        payload: options.payload\n      }\n    ]\n  ];\n  async function traverse({\n    currentId,\n    flatIndex,\n    intent,\n    params,\n    parent: parent2,\n    path,\n    payload,\n    unresolvedPane,\n    levelIndex,\n    structureContext\n  }) {\n    if (!unresolvedPane) return [];\n    const { id: targetId, type: schemaTypeName, ...otherParams } = params, resolvedPane = await (0,rxjs__WEBPACK_IMPORTED_MODULE_16__.firstValueFrom)(resolvePane(unresolvedPane, {\n      id: currentId,\n      splitIndex: 0,\n      parent: parent2,\n      path,\n      index: flatIndex,\n      params: {},\n      payload: void 0,\n      structureContext\n    }, flatIndex));\n    return resolvedPane.type === \"document\" && resolvedPane.id === targetId ? [\n      {\n        panes: [\n          ...path.slice(0, path.length - 1).map((i) => [{ id: i }]),\n          [{ id: targetId, params: otherParams, payload }]\n        ],\n        depthIndex: path.length,\n        levelIndex\n      }\n    ] : (\n      // if the resolve pane's `canHandleIntent` returns true, then resolve\n      resolvedPane.canHandleIntent?.(intent, params, {\n        pane: resolvedPane,\n        index: flatIndex\n      }) || // if the pane's `canHandleIntent` did not return true, then match against\n      // this default case. we will resolve the intent if:\n      resolvedPane.type === \"documentList\" && // 1. the schema type matches (this required for the document to render)\n      resolvedPane.schemaTypeName === schemaTypeName && // 2. the filter is the default filter.\n      //\n      // NOTE: this case is to prevent false positive matches where the user\n      // has configured a more specific filter for a particular type. In that\n      // case, the user can implement their own `canHandleIntent` function\n      resolvedPane.options.filter === \"_type == $type\" ? [\n        {\n          panes: [\n            // map the current path to router panes\n            ...path.map((id) => [{ id }]),\n            // then augment with the intents IDs and params\n            [{ id: params.id, params: otherParams, payload }]\n          ],\n          depthIndex: path.length,\n          levelIndex\n        }\n      ] : resolvedPane.type === \"list\" && resolvedPane.child && resolvedPane.items ? (await Promise.all(\n        resolvedPane.items.map((item, nextLevelIndex) => item.type === \"divider\" ? Promise.resolve([]) : traverse({\n          currentId: item._id || item.id,\n          flatIndex: flatIndex + 1,\n          intent,\n          params,\n          parent: resolvedPane,\n          path: [...path, item.id],\n          payload,\n          unresolvedPane: typeof resolvedPane.child == \"function\" ? memoBind(resolvedPane, \"child\") : resolvedPane.child,\n          levelIndex: nextLevelIndex,\n          structureContext\n        }))\n      )).flat() : []\n    );\n  }\n  const closestPaneToRoot = (await traverse({\n    currentId: \"root\",\n    flatIndex: 0,\n    levelIndex: 0,\n    intent: options.intent,\n    params: options.params,\n    parent: null,\n    path: [],\n    payload: options.payload,\n    unresolvedPane: options.rootPaneNode,\n    structureContext: options.structureContext\n  })).sort((a, b) => a.depthIndex === b.depthIndex ? a.levelIndex - b.levelIndex : a.depthIndex - b.depthIndex)[0];\n  return closestPaneToRoot ? closestPaneToRoot.panes : fallbackEditorPanes;\n}\nconst fallbackEditorChild = (nodeId, context) => {\n  const id = nodeId.replace(/^__edit__/, \"\"), {\n    params,\n    payload,\n    structureContext: { resolveDocumentNode }\n  } = context, { type, template } = params;\n  if (!type)\n    throw new Error(\n      `Document type for document with ID ${id} was not provided in the router params.`\n    );\n  let defaultDocumentBuilder = resolveDocumentNode({ schemaType: type, documentId: id }).id(\"editor\");\n  return template && (defaultDocumentBuilder = defaultDocumentBuilder.initialValueTemplate(\n    template,\n    payload\n  )), defaultDocumentBuilder.serialize();\n};\nfunction hashContext(context) {\n  return `contextHash(${JSON.stringify({\n    id: context.id,\n    parentId: parent && assignId(parent),\n    path: context.path,\n    index: context.index,\n    splitIndex: context.splitIndex,\n    serializeOptionsIndex: context.serializeOptions?.index,\n    serializeOptionsPath: context.serializeOptions?.path\n  })})`;\n}\nconst hashResolvedPaneMeta = (meta) => {\n  const normalized = {\n    type: meta.type,\n    id: meta.routerPaneSibling.id,\n    params: meta.routerPaneSibling.params || {},\n    payload: meta.routerPaneSibling.payload || null,\n    flatIndex: meta.flatIndex,\n    groupIndex: meta.groupIndex,\n    siblingIndex: meta.siblingIndex,\n    path: meta.path,\n    paneNode: meta.type === \"resolvedMeta\" ? assignId(meta.paneNode) : null\n  };\n  return `metaHash(${JSON.stringify(normalized)})`;\n};\nfunction resolvePaneTree({\n  unresolvedPane,\n  flattenedRouterPanes,\n  parent: parent2,\n  path,\n  resolvePane,\n  structureContext\n}) {\n  const [current, ...rest] = flattenedRouterPanes, next = rest[0], context = {\n    id: current.routerPaneSibling.id,\n    splitIndex: current.siblingIndex,\n    parent: parent2,\n    path: [...path, current.routerPaneSibling.id],\n    index: current.flatIndex,\n    params: current.routerPaneSibling.params || {},\n    payload: current.routerPaneSibling.payload,\n    structureContext\n  };\n  try {\n    return resolvePane(unresolvedPane, context, current.flatIndex).pipe(\n      // this switch map receives a resolved pane\n      (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.switchMap)((paneNode) => {\n        const resolvedPaneMeta = {\n          type: \"resolvedMeta\",\n          ...current,\n          paneNode,\n          path: context.path\n        }, loadingPanes = rest.map((i, restIndex) => ({\n          type: \"loading\",\n          path: [\n            ...context.path,\n            ...rest.slice(restIndex).map((_, currentIndex) => `[${i.flatIndex + currentIndex}]`)\n          ],\n          paneNode: null,\n          ...i\n        }));\n        if (!rest.length)\n          return (0,rxjs__WEBPACK_IMPORTED_MODULE_15__.of)([resolvedPaneMeta]);\n        let nextStream;\n        return (\n          /* the fallback editor case */\n          next?.routerPaneSibling.id.startsWith(\"__edit__\") ? nextStream = resolvePaneTree({\n            unresolvedPane: fallbackEditorChild,\n            flattenedRouterPanes: rest,\n            parent: parent2,\n            path: context.path,\n            resolvePane,\n            structureContext\n          }) : current.groupIndex === next?.groupIndex ? nextStream = resolvePaneTree({\n            unresolvedPane,\n            flattenedRouterPanes: rest,\n            parent: parent2,\n            path,\n            resolvePane,\n            structureContext\n          }) : nextStream = resolvePaneTree({\n            unresolvedPane: typeof paneNode.child == \"function\" ? memoBind(paneNode, \"child\") : paneNode.child,\n            flattenedRouterPanes: rest,\n            parent: paneNode,\n            path: context.path,\n            resolvePane,\n            structureContext\n          }), (0,rxjs__WEBPACK_IMPORTED_MODULE_17__.concat)(\n            // we emit the loading panes first in a concat (this emits immediately)\n            (0,rxjs__WEBPACK_IMPORTED_MODULE_15__.of)([resolvedPaneMeta, ...loadingPanes]),\n            // then whenever the next stream is done, the results will be combined.\n            nextStream.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)((nextResolvedPanes) => [resolvedPaneMeta, ...nextResolvedPanes]))\n          )\n        );\n      })\n    );\n  } catch (e) {\n    if (e instanceof PaneResolutionError && (e.context && console.warn(\n      `Pane resolution error at index ${e.context.index}${e.context.splitIndex > 0 ? ` for split pane index ${e.context.splitIndex}` : \"\"}: ${e.message}${e.helpId ? ` - see ${(0,_generate_help_url_esm_mjs__WEBPACK_IMPORTED_MODULE_19__.generateHelpUrl)(e.helpId)}` : \"\"}`,\n      e\n    ), e.helpId === \"structure-item-returned-no-child\"))\n      return (0,rxjs__WEBPACK_IMPORTED_MODULE_15__.of)([]);\n    throw e;\n  }\n}\nfunction createResolvedPaneNodeStream({\n  routerPanesStream,\n  rootPaneNode,\n  initialCacheState = {\n    cacheKeysByFlatIndex: [],\n    flattenedRouterPanes: [],\n    resolvedPaneCache: /* @__PURE__ */ new Map(),\n    resolvePane: () => rxjs__WEBPACK_IMPORTED_MODULE_20__.NEVER\n  },\n  structureContext\n}) {\n  return routerPanesStream.pipe(\n    // add in implicit \"root\" router pane\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)((rawRouterPanes) => [[{ id: \"root\" }], ...rawRouterPanes]),\n    // create flattened router panes\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)((routerPanes) => routerPanes.flatMap(\n      (routerPaneGroup, groupIndex) => routerPaneGroup.map((routerPaneSibling, siblingIndex) => ({\n        routerPaneSibling,\n        groupIndex,\n        siblingIndex\n      }))\n    ).map((i, index) => ({ ...i, flatIndex: index }))),\n    // calculate a \"diffIndex\" used for clearing the memo cache\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.startWith)([]),\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.pairwise)(),\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)(([prev, curr]) => {\n      for (let i = 0; i < curr.length; i++) {\n        const prevValue = prev[i], currValue = curr[i];\n        if (!lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__(prevValue, currValue))\n          return {\n            flattenedRouterPanes: curr,\n            diffIndex: i\n          };\n      }\n      return {\n        flattenedRouterPanes: curr,\n        diffIndex: curr.length\n      };\n    }),\n    // create the memoized `resolvePane` function and manage the memo cache\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_23__.scan)((acc, next) => {\n      const { cacheKeysByFlatIndex, resolvedPaneCache } = acc, { flattenedRouterPanes, diffIndex } = next, beforeDiffIndex = cacheKeysByFlatIndex.slice(0, diffIndex + 1), afterDiffIndex = cacheKeysByFlatIndex.slice(diffIndex + 1), keysToKeep = new Set(beforeDiffIndex.flatMap((keySet) => Array.from(keySet))), keysToDelete = afterDiffIndex.flatMap((keySet) => Array.from(keySet)).filter((key) => !keysToKeep.has(key));\n      for (const key of keysToDelete)\n        resolvedPaneCache.delete(key);\n      return {\n        flattenedRouterPanes,\n        cacheKeysByFlatIndex,\n        resolvedPaneCache,\n        resolvePane: createPaneResolver((nextFn) => (unresolvedPane, context, flatIndex) => {\n          const key = unresolvedPane && `${assignId(unresolvedPane)}-${hashContext(context)}`, cachedResolvedPane = key && resolvedPaneCache.get(key);\n          if (cachedResolvedPane) return cachedResolvedPane;\n          const result = nextFn(unresolvedPane, context, flatIndex);\n          if (!key) return result;\n          const cacheKeySet = cacheKeysByFlatIndex[flatIndex] || /* @__PURE__ */ new Set();\n          return cacheKeySet.add(key), cacheKeysByFlatIndex[flatIndex] = cacheKeySet, resolvedPaneCache.set(key, result), result;\n        })\n      };\n    }, initialCacheState),\n    // run the memoized, recursive resolving\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.switchMap)(\n      ({ flattenedRouterPanes, resolvePane }) => resolvePaneTree({\n        unresolvedPane: rootPaneNode,\n        flattenedRouterPanes,\n        parent: null,\n        path: [],\n        resolvePane,\n        structureContext\n      })\n    )\n  ).pipe(\n    // this diffs the previous emission with the current one. if there is a new\n    // loading pane at the same position where a previous pane already had a\n    // resolved value (looking at the IDs to compare), then return the previous\n    // pane instead of the loading pane\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_23__.scan)(\n      (prev, next) => next.map((nextPane, index) => {\n        const prevPane = prev[index];\n        return !prevPane || nextPane.type !== \"loading\" ? nextPane : prevPane.routerPaneSibling.id === nextPane.routerPaneSibling.id ? prevPane : nextPane;\n      }),\n      []\n    ),\n    // this prevents duplicate emissions\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_24__.distinctUntilChanged)((prev, next) => {\n      if (prev.length !== next.length) return !1;\n      for (let i = 0; i < next.length; i++) {\n        const prevValue = prev[i], nextValue = next[i];\n        if (hashResolvedPaneMeta(prevValue) !== hashResolvedPaneMeta(nextValue))\n          return !1;\n      }\n      return !0;\n    })\n  );\n}\nfunction useRouterPanesStream() {\n  const routerStateSubject = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new rxjs__WEBPACK_IMPORTED_MODULE_25__.ReplaySubject(1), []), routerPanes$ = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(\n    () => routerStateSubject.asObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)((_routerState) => _routerState?.panes || [])),\n    [routerStateSubject]\n  ), { state: routerState } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)();\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    routerStateSubject.next(routerState);\n  }, [routerState, routerStateSubject]), routerPanes$;\n}\nfunction useResolvedPanes() {\n  const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();\n  if (error) throw error;\n  const { structureContext, rootPaneNode } = (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.useStructureTool)(), [data, setData] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n    paneDataItems: [],\n    resolvedPanes: [],\n    routerPanes: []\n  }), routerPanesStream = useRouterPanesStream();\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const subscription = createResolvedPaneNodeStream({\n      rootPaneNode,\n      routerPanesStream,\n      structureContext\n    }).pipe(\n      (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)((resolvedPanes) => {\n        const routerPanes = resolvedPanes.reduce((acc, next) => {\n          const currentGroup = acc[next.groupIndex] || [];\n          return currentGroup[next.siblingIndex] = next.routerPaneSibling, acc[next.groupIndex] = currentGroup, acc;\n        }, []), groupsLen = routerPanes.length, paneDataItems = resolvedPanes.map((pane) => {\n          const { groupIndex, flatIndex, siblingIndex, routerPaneSibling, path } = pane, itemId = routerPaneSibling.id, nextGroup = routerPanes[groupIndex + 1];\n          return {\n            active: groupIndex === groupsLen - 2,\n            childItemId: nextGroup?.[0].id ?? null,\n            index: flatIndex,\n            itemId: routerPaneSibling.id,\n            groupIndex,\n            key: `${pane.type === \"loading\" ? \"unknown\" : pane.paneNode.id}-${itemId}-${siblingIndex}`,\n            pane: pane.type === \"loading\" ? _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LOADING_PANE : pane.paneNode,\n            params: routerPaneSibling.params || {},\n            path: path.join(\";\"),\n            payload: routerPaneSibling.payload,\n            selected: flatIndex === resolvedPanes.length - 1,\n            siblingIndex\n          };\n        });\n        return {\n          paneDataItems,\n          routerPanes,\n          resolvedPanes: paneDataItems.map((pane) => pane.pane)\n        };\n      })\n    ).subscribe({\n      next: (result) => setData(result),\n      error: (e) => setError(e)\n    });\n    return () => subscription.unsubscribe();\n  }, [rootPaneNode, routerPanesStream, structureContext]), data;\n}\nasync function ensureDocumentIdAndType(documentStore, id, type) {\n  if (id && type) return { id, type };\n  if (!id && type) return { id: (0,_sanity_uuid__WEBPACK_IMPORTED_MODULE_26__[\"default\"])(), type };\n  if (id && !type) {\n    const resolvedType = await (0,rxjs__WEBPACK_IMPORTED_MODULE_16__.firstValueFrom)(\n      documentStore.resolveTypeForDocument(id)\n    );\n    return { id, type: resolvedType };\n  }\n  throw new PaneResolutionError({\n    message: \"Neither document `id` or `type` was provided when trying to resolve intent.\"\n  });\n}\nconst EMPTY_RECORD = {}, IntentResolver = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(function() {\n  const { navigate } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)(), maybeIntent = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouterState)(\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((routerState) => {\n      const intentName = typeof routerState.intent == \"string\" ? routerState.intent : void 0;\n      return intentName ? {\n        intent: intentName,\n        params: (0,sanity__WEBPACK_IMPORTED_MODULE_9__.isRecord)(routerState.params) ? routerState.params : EMPTY_RECORD,\n        payload: routerState.payload\n      } : void 0;\n    }, [])\n  ), { rootPaneNode, structureContext } = (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.useStructureTool)(), documentStore = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useDocumentStore)(), [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n  if (error) throw error;\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (maybeIntent) {\n      const { intent, params, payload } = maybeIntent;\n      let cancelled = !1;\n      async function effect() {\n        const { id, type } = await ensureDocumentIdAndType(\n          documentStore,\n          typeof params.id == \"string\" ? params.id : void 0,\n          typeof params.type == \"string\" ? params.type : void 0\n        );\n        if (cancelled) return;\n        const panes = await resolveIntent({\n          intent,\n          params: { ...params, id, type },\n          payload,\n          rootPaneNode,\n          structureContext\n        });\n        cancelled || navigate({ panes }, { replace: !0 });\n      }\n      return effect().catch(setError), () => {\n        cancelled = !0;\n      };\n    }\n  }, [documentStore, maybeIntent, navigate, rootPaneNode, structureContext]), null;\n}), PathSegment = styled_components__WEBPACK_IMPORTED_MODULE_27__.styled.span`\n  &:not(:last-child)::after {\n    content: ' âž ';\n    opacity: 0.5;\n  }\n`;\nfunction formatStack(stack) {\n  return stack.replace(/\\(\\.\\.\\.\\)\\./g, `(...)\n  .`).replace(/__WEBPACK_IMPORTED_MODULE_\\d+_+/g, \"\").replace(/___default\\./g, \".\").replace(new RegExp(` \\\\(https?:\\\\/\\\\/${window.location.host}`, \"g\"), \" (\");\n}\nfunction StructureError({ error }) {\n  if (!(error instanceof PaneResolutionError))\n    throw error;\n  const { cause } = error, { t } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useTranslation)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.structureLocaleNamespace), stack = cause?.stack || error.stack, showStack = stack && !(cause instanceof _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.SerializeError) && !error.message.includes(\"Module build failed:\"), path = cause instanceof _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.SerializeError ? cause.path : [], helpId = cause instanceof _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.SerializeError && cause.helpId || error.helpId, handleReload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    window.location.reload();\n  }, []);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Card, { height: \"fill\", overflow: \"auto\", padding: 4, sizing: \"border\", tone: \"critical\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Container, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Heading, { as: \"h2\", children: t(\"structure-error.header.text\") }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Card, { marginTop: 4, padding: 4, radius: 2, overflow: \"auto\", shadow: 1, tone: \"inherit\", children: [\n      path.length > 0 && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Stack, { space: 2, children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { size: 1, weight: \"medium\", children: t(\"structure-error.structure-path.label\") }),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Code, { children: path.slice(1).map((segment, i) => (\n          // eslint-disable-next-line react/no-array-index-key\n          /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PathSegment, { children: segment }, `${segment}-${i}`)\n        )) })\n      ] }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Stack, { marginTop: 4, space: 2, children: [\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { size: 1, weight: \"medium\", children: t(\"structure-error.error.label\") }),\n        /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Code, { children: showStack ? formatStack(stack) : error.message })\n      ] }),\n      helpId && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Box, { marginTop: 4, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"a\", { href: (0,_generate_help_url_esm_mjs__WEBPACK_IMPORTED_MODULE_19__.generateHelpUrl)(helpId), rel: \"noopener noreferrer\", target: \"_blank\", children: t(\"structure-error.docs-link.text\") }) }) }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Box, { marginTop: 4, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        _generate_help_url_esm_mjs__WEBPACK_IMPORTED_MODULE_19__.Button,\n        {\n          text: t(\"structure-error.reload-button.text\"),\n          icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_29__.SyncIcon,\n          tone: \"primary\",\n          onClick: handleReload\n        }\n      ) })\n    ] })\n  ] }) });\n}\nfunction UnknownPane(props) {\n  const { isSelected, pane, paneKey } = props, type = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.isRecord)(pane) && pane.type || null, { t } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useTranslation)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.structureLocaleNamespace);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.Pane, { id: paneKey, selected: isSelected, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.PaneHeader, { title: t(\"panes.unknown-pane-type.title\") }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.PaneContent, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Box, { padding: 4, children: typeof type == \"string\" ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { as: \"p\", muted: !0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      sanity__WEBPACK_IMPORTED_MODULE_9__.Translate,\n      {\n        t,\n        i18nKey: \"panes.unknown-pane-type.unknown-type.text\",\n        values: { type }\n      }\n    ) }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { as: \"p\", muted: !0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity__WEBPACK_IMPORTED_MODULE_9__.Translate, { t, i18nKey: \"panes.unknown-pane-type.missing-type.text\" }) }) }) })\n  ] });\n}\nconst paneMap = {\n  component: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks-es_index_mjs\").then(__webpack_require__.bind(__webpack_require__, /*! ./index.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/index.mjs\"))),\n  document: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./pane.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/pane.mjs\")).then(function(n) {\n    return n.pane;\n  })),\n  documentList: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./pane.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/pane.mjs\")).then(function(n) {\n    return n.pane$1;\n  })),\n  list: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks-es_index2_mjs\").then(__webpack_require__.bind(__webpack_require__, /*! ./index2.mjs */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/index2.mjs\")))\n}, StructureToolPane = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(\n  function(props) {\n    const {\n      active,\n      childItemId,\n      groupIndex,\n      index,\n      itemId,\n      pane,\n      paneKey,\n      params,\n      payload,\n      path,\n      selected,\n      siblingIndex\n    } = props, PaneComponent = paneMap[pane.type] || UnknownPane;\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n      PaneRouterProvider,\n      {\n        flatIndex: index,\n        index: groupIndex,\n        params,\n        payload,\n        siblingIndex,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, { fallback: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LoadingPane, { paneKey, path, selected }), children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n          PaneComponent,\n          {\n            childItemId: childItemId || \"\",\n            index,\n            itemId,\n            isActive: active,\n            isSelected: selected,\n            paneKey,\n            pane\n          }\n        ) })\n      }\n    );\n  },\n  ({ params: prevParams = {}, payload: prevPayload = null, ...prev }, { params: nextParams = {}, payload: nextPayload = null, ...next }) => {\n    if (!lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__(prevParams, nextParams) || !lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__(prevPayload, nextPayload)) return !1;\n    const keys = /* @__PURE__ */ new Set([...Object.keys(prev), ...Object.keys(next)]);\n    for (const key of keys)\n      if (prev[key] !== next[key]) return !1;\n    return !0;\n  }\n);\nfunction NoDocumentTypesScreen() {\n  const { t } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useTranslation)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.structureLocaleNamespace);\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Card, { height: \"fill\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Flex, { align: \"center\", height: \"fill\", justify: \"center\", padding: 4, sizing: \"border\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Container, { width: 0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Card, { padding: 4, radius: 2, shadow: 1, tone: \"caution\", children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Flex, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Box, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { size: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_29__.WarningOutlineIcon, {}) }) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Stack, { flex: 1, marginLeft: 3, space: 3, children: [\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { as: \"h1\", size: 1, weight: \"medium\", children: t(\"no-document-types-screen.title\") }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { as: \"p\", muted: !0, size: 1, children: t(\"no-document-types-screen.subtitle\") }),\n      /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.Text, { as: \"p\", muted: !0, size: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n        \"a\",\n        {\n          href: \"https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio\",\n          target: \"_blank\",\n          rel: \"noreferrer\",\n          children: t(\"no-document-types-screen.link-text\")\n        }\n      ) })\n    ] })\n  ] }) }) }) }) });\n}\nconst DocumentTitle = (props) => {\n  const { documentId, documentType } = props, editState = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useEditState)(documentId, documentType), schema = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useSchema)(), { t } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useTranslation)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.structureLocaleNamespace), isNewDocument = !editState?.published && !editState?.draft, documentValue = editState?.draft || editState?.published, schemaType = schema.get(documentType), { value, isLoading: previewValueIsLoading } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.unstable_useValuePreview)({\n    enabled: !0,\n    schemaType,\n    value: documentValue\n  }), documentTitle = isNewDocument ? t(\"browser-document-title.new-document\", {\n    schemaType: schemaType?.title || schemaType?.name\n  }) : value?.title || t(\"browser-document-title.untitled-document\"), settled = editState.ready && !previewValueIsLoading, newTitle = useConstructDocumentTitle(documentTitle);\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    settled && (document.title = newTitle);\n  }, [documentTitle, settled, newTitle]), null;\n}, PassthroughTitle = (props) => {\n  const { title } = props, newTitle = useConstructDocumentTitle(title);\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    document.title = newTitle;\n  }, [newTitle, title]), null;\n}, StructureTitle = (props) => {\n  const { resolvedPanes } = props;\n  if (!resolvedPanes?.length) return null;\n  const lastPane = resolvedPanes[resolvedPanes.length - 1];\n  return isLoadingPane(lastPane) ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, {}) : isDocumentPane(lastPane) ? lastPane?.title ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, { title: lastPane.title }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DocumentTitle, { documentId: lastPane.options.id, documentType: lastPane.options.type }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, { title: lastPane?.title });\n};\nfunction useConstructDocumentTitle(activeTitle) {\n  const structureToolBaseTitle = (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.useStructureTool)().structureContext.title;\n  return [activeTitle, structureToolBaseTitle].filter((title) => title).join(\" | \");\n}\nfunction isDocumentPane(pane) {\n  return pane !== _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LOADING_PANE && pane.type === \"document\";\n}\nfunction isLoadingPane(pane) {\n  return pane === _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LOADING_PANE;\n}\nconst StyledPaneLayout = (0,styled_components__WEBPACK_IMPORTED_MODULE_27__.styled)((0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.PaneLayout))`\n  min-height: 100%;\n  min-width: 320px;\n`, isSaveHotkey = (0,is_hotkey_esm__WEBPACK_IMPORTED_MODULE_30__.isHotkey)(\"mod+s\"), StructureTool = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(function({ onPaneChange }) {\n  const { push: pushToast } = (0,_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.useToast)(), schema = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useSchema)(), { layoutCollapsed, setLayoutCollapsed } = (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.useStructureTool)(), { paneDataItems, resolvedPanes } = useResolvedPanes(), isResolvingIntent = (0,sanity_router__WEBPACK_IMPORTED_MODULE_4__.useRouterState)(\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((routerState) => typeof routerState.intent == \"string\", [])\n  ), {\n    sanity: { media }\n  } = (0,_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.useTheme)(), [portalElement, setPortalElement] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null), handleRootCollapse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => setLayoutCollapsed(!0), [setLayoutCollapsed]), handleRootExpand = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => setLayoutCollapsed(!1), [setLayoutCollapsed]);\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    resolvedPanes.length && onPaneChange(resolvedPanes);\n  }, [onPaneChange, resolvedPanes]), (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const handleGlobalKeyDown = (event) => {\n      isSaveHotkey(event) && (event.preventDefault(), pushToast({\n        closable: !0,\n        id: \"auto-save-message\",\n        status: \"info\",\n        title: \"Your work is automatically saved!\",\n        duration: 4e3\n      }));\n    };\n    return window.addEventListener(\"keydown\", handleGlobalKeyDown), () => window.removeEventListener(\"keydown\", handleGlobalKeyDown);\n  }, [pushToast]), schema._original?.types.some(sanity__WEBPACK_IMPORTED_MODULE_9__._isCustomDocumentTypeDefinition) ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_28__.PortalProvider, { element: portalElement || null, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\n      StyledPaneLayout,\n      {\n        flex: 1,\n        height: layoutCollapsed ? void 0 : \"fill\",\n        minWidth: media[1],\n        onCollapse: handleRootCollapse,\n        onExpand: handleRootExpand,\n        children: [\n          paneDataItems.map(\n            ({\n              active,\n              childItemId,\n              groupIndex,\n              itemId,\n              key: paneKey,\n              pane,\n              index: paneIndex,\n              params: paneParams,\n              path,\n              payload,\n              siblingIndex,\n              selected\n            }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: pane === _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LOADING_PANE ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LoadingPane, { paneKey, path, selected }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n              StructureToolPane,\n              {\n                active,\n                groupIndex,\n                index: paneIndex,\n                pane,\n                childItemId,\n                itemId,\n                paneKey,\n                params: paneParams,\n                payload,\n                path,\n                selected,\n                siblingIndex\n              }\n            ) }, `${pane === _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LOADING_PANE ? \"loading\" : pane.type}-${paneIndex}`)\n          ),\n          paneDataItems.length <= 1 && isResolvingIntent && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.LoadingPane, { paneKey: \"intent-resolver\" })\n        ]\n      }\n    ),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureTitle, { resolvedPanes }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { \"data-portal\": \"\", ref: setPortalElement })\n  ] }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(NoDocumentTypesScreen, {});\n});\nfunction StructureToolBoundary({ tool: { options } }) {\n  const { unstable_sources: sources } = (0,sanity__WEBPACK_IMPORTED_MODULE_9__.useWorkspace)(), [firstSource] = sources, { source, defaultDocumentNode, structure } = options || {};\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => ((0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.setActivePanes)([]), () => (0,_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.setActivePanes)([])), []);\n  const [{ error }, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({ error: null });\n  return error ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureError, { error }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_generate_help_url_esm_mjs__WEBPACK_IMPORTED_MODULE_19__.ErrorBoundary, { onCatch: setError, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity__WEBPACK_IMPORTED_MODULE_9__.SourceProvider, { name: source || firstSource.name, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_pane_mjs__WEBPACK_IMPORTED_MODULE_5__.StructureToolProvider, { defaultDocumentNode, structure, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureTool, { onPaneChange: _pane_mjs__WEBPACK_IMPORTED_MODULE_5__.setActivePanes }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(IntentResolver, {})\n  ] }) }) });\n}\n\n//# sourceMappingURL=index3.mjs.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9zYW5pdHkvbGliL19jaHVua3MtZXMvaW5kZXgzLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE4QztBQUNvRDtBQUMrRjtBQUM1RztBQUMyTDtBQUN0TjtBQUN4QjtBQUMwRDtBQUM1RDtBQUMwRjtBQUN0RjtBQUN5QjtBQUMyRDtBQUM3RTtBQUNmO0FBQ2E7QUFDRDtBQUNNO0FBQ1M7QUFDdkQ7QUFDQTtBQUNBLFVBQVUsNERBQTRELFdBQVcsaURBQWlELEVBQUUsd0RBQVMsa0JBQWtCLDZEQUFjLE1BQU0sZ0JBQWdCLEVBQUUsd0RBQWEsdUJBQXVCLDhDQUFPO0FBQ2hQO0FBQ0E7QUFDQSxnQkFBZ0IsOENBQU8sNEZBQTRGLGtEQUFXO0FBQzlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0JBQW9CO0FBQ25DLEtBQUs7QUFDTDtBQUNBLDBCQUEwQixrREFBVztBQUNyQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw0QkFBNEIsa0RBQVc7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsVUFBVSw2QkFBNkI7QUFDdkM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0JBQWtCLGtEQUFXO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0JBQStCO0FBQ3pDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxpQkFBaUIsa0RBQVc7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsVUFBVSw2QkFBNkI7QUFDdkM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDJCQUEyQixrREFBVztBQUN0QyxPQUFPLG1DQUFtQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0NBQXNDLDREQUFRLHVCQUF1QjtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxXQUFXLDhDQUFPO0FB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QUNBO0FBQ0EsYUFBYSxxQkFBcUIsc0RBQUcsQ0FBQywyQ0FBUSxJQUFJLG1CQUFtQixtREFBWSxtQkFBbUIsc0RBQUcsQ0FBQyxrREFBVyxJQUFJLHlCQUF5QixvQkFBb0Isc0RBQUc7QUFDdks7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxLQUFLLFNBQVMsbURBQVkseUJBQXlCLEdBQUcsVUFBVTtBQUMvRTtBQUNBLDRFQUE0RSxzREFBRyxDQUFDLGtEQUFXLElBQUksNEJBQTRCO0FBQzNIO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzREFBRyxtQkFBbUIsZUFBZTtBQUN6RCxvQkFBb0Isc0RBQUcsVUFBVSwwQ0FBMEM7QUFDM0UsS0FBSyxvQkFBb0Isc0RBQUcsMEJBQTBCO0FBQ3RELENBQUM7QUFDRCxpQ0FBaUMsUUFBUSxXQUFXO0FBQ3BELFVBQVUsNEJBQTRCLEVBQUUsb0RBQVksK0JBQStCLHlDQUF5QztBQUM1SCxFQUFFLGdEQUFTLFFBQVEseURBQWMsWUFBWSx5REFBYztBQUMzRCxXQUFXLE9BQU8sY0FBYywrQ0FBUSxHQUFHLGFBQWE7QUFDeEQsaUNBQWlDLHNEQUFHLG1CQUFtQixPQUFPLG9CQUFvQixzREFBRyxDQUFDLHNFQUFhLElBQUksNkNBQTZDLHNEQUFHLENBQUMsa0RBQWMsSUFBSSw0REFBNEQsdURBQUksQ0FBQyw0REFBcUIsSUFBSTtBQUNwUSxvQkFBb0Isc0RBQUcsa0JBQWtCLGNBQWMscURBQWMsRUFBRTtBQUN2RSxvQkFBb0Isc0RBQUcsbUJBQW1CO0FBQzFDLEtBQUssR0FBRyxHQUFHO0FBQ1g7QUFHRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9zYW5pdHkvbGliL19jaHVua3MtZXMvaW5kZXgzLm1qcz8xYjgyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpzeCwganN4cyB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xuaW1wb3J0IHsgdXNlTWVtbywgdXNlQ2FsbGJhY2ssIHVzZVN0YXRlLCB1c2VFZmZlY3QsIG1lbW8sIGxhenksIFN1c3BlbnNlLCBGcmFnbWVudCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgaXNSZWNvcmQsIHVzZURvY3VtZW50U3RvcmUsIHVzZVRyYW5zbGF0aW9uLCBUcmFuc2xhdGUsIHVzZUVkaXRTdGF0ZSwgdXNlU2NoZW1hLCB1bnN0YWJsZV91c2VWYWx1ZVByZXZpZXcsIF9pc0N1c3RvbURvY3VtZW50VHlwZURlZmluaXRpb24sIHVzZVdvcmtzcGFjZSwgU291cmNlUHJvdmlkZXIgfSBmcm9tIFwic2FuaXR5XCI7XG5pbXBvcnQgeyBnZW5lcmF0ZUhlbHBVcmwsIEJ1dHRvbiwgRXJyb3JCb3VuZGFyeSB9IGZyb20gXCIuL2dlbmVyYXRlLWhlbHAtdXJsLmVzbS5tanNcIjtcbmltcG9ydCB7IHVzZVBhbmVMYXlvdXQsIENoaWxkTGluaywgQmFja0xpbmssIFJlZmVyZW5jZUNoaWxkTGluaywgUGFyYW1ldGVyaXplZExpbmssIHVzZVN0cnVjdHVyZVRvb2wsIExPQURJTkdfUEFORSwgc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlLCBTZXJpYWxpemVFcnJvciwgUGFuZSwgUGFuZUhlYWRlciwgUGFuZUNvbnRlbnQsIExvYWRpbmdQYW5lLCBQYW5lTGF5b3V0LCBzZXRBY3RpdmVQYW5lcywgU3RydWN0dXJlVG9vbFByb3ZpZGVyIH0gZnJvbSBcIi4vcGFuZS5tanNcIjtcbmltcG9ydCB7IHVzZVJvdXRlciwgdXNlUm91dGVyU3RhdGUgfSBmcm9tIFwic2FuaXR5L3JvdXRlclwiO1xuaW1wb3J0IG9taXQgZnJvbSBcImxvZGFzaC9vbWl0LmpzXCI7XG5pbXBvcnQgeyBpc09ic2VydmFibGUsIGZyb20sIG9mLCBmaXJzdFZhbHVlRnJvbSwgTkVWRVIsIGNvbmNhdCwgUmVwbGF5U3ViamVjdCB9IGZyb20gXCJyeGpzXCI7XG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tIFwibmFub2lkXCI7XG5pbXBvcnQgeyBzd2l0Y2hNYXAsIHB1Ymxpc2hSZXBsYXksIHJlZkNvdW50LCBtYXAsIHN0YXJ0V2l0aCwgcGFpcndpc2UsIHNjYW4sIGRpc3RpbmN0VW50aWxDaGFuZ2VkIH0gZnJvbSBcInJ4anMvb3BlcmF0b3JzXCI7XG5pbXBvcnQgeyB1dWlkIH0gZnJvbSBcIkBzYW5pdHkvdXVpZFwiO1xuaW1wb3J0IHsgU3luY0ljb24sIFdhcm5pbmdPdXRsaW5lSWNvbiB9IGZyb20gXCJAc2FuaXR5L2ljb25zXCI7XG5pbXBvcnQgeyBDYXJkLCBDb250YWluZXIsIEhlYWRpbmcsIFN0YWNrLCBUZXh0LCBDb2RlLCBCb3gsIEZsZXgsIHVzZVRvYXN0LCB1c2VUaGVtZSwgUG9ydGFsUHJvdmlkZXIgfSBmcm9tIFwiQHNhbml0eS91aVwiO1xuaW1wb3J0IHsgc3R5bGVkIH0gZnJvbSBcInN0eWxlZC1jb21wb25lbnRzXCI7XG5pbXBvcnQgXCIuLi9fc2luZ2xldG9ucy5tanNcIjtcbmltcG9ydCB7IGlzSG90a2V5IH0gZnJvbSBcImlzLWhvdGtleS1lc21cIjtcbmltcG9ydCBpc0VxdWFsIGZyb20gXCJsb2Rhc2gvaXNFcXVhbC5qc1wiO1xuaW1wb3J0IHsgdG9TdHJpbmcgfSBmcm9tIFwiQHNhbml0eS91dGlsL3BhdGhzXCI7XG5pbXBvcnQgeyBQYW5lUm91dGVyQ29udGV4dCB9IGZyb20gXCJzYW5pdHkvX3NpbmdsZXRvbnNcIjtcbmNvbnN0IGVtcHR5QXJyYXkgPSBbXTtcbmZ1bmN0aW9uIFBhbmVSb3V0ZXJQcm92aWRlcihwcm9wcykge1xuICBjb25zdCB7IGNoaWxkcmVuLCBmbGF0SW5kZXgsIGluZGV4LCBwYXJhbXMsIHBheWxvYWQsIHNpYmxpbmdJbmRleCB9ID0gcHJvcHMsIHsgbmF2aWdhdGUsIG5hdmlnYXRlSW50ZW50LCByZXNvbHZlUGF0aEZyb21TdGF0ZSB9ID0gdXNlUm91dGVyKCksIHJvdXRlclN0YXRlID0gdXNlUm91dGVyU3RhdGUoKSwgeyBwYW5lcywgZXhwYW5kIH0gPSB1c2VQYW5lTGF5b3V0KCksIHJvdXRlclBhbmVHcm91cHMgPSB1c2VNZW1vKFxuICAgICgpID0+IHJvdXRlclN0YXRlPy5wYW5lcyB8fCBlbXB0eUFycmF5LFxuICAgIFtyb3V0ZXJTdGF0ZT8ucGFuZXNdXG4gICksIGxhc3RQYW5lID0gdXNlTWVtbygoKSA9PiBwYW5lcz8uW3BhbmVzLmxlbmd0aCAtIDJdLCBbcGFuZXNdKSwgZ3JvdXBJbmRleCA9IGluZGV4IC0gMSwgY3JlYXRlTmV4dFJvdXRlclN0YXRlID0gdXNlQ2FsbGJhY2soXG4gICAgKG1vZGlmaWVyKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50R3JvdXAgPSByb3V0ZXJQYW5lR3JvdXBzW2dyb3VwSW5kZXhdIHx8IFtdLCBjdXJyZW50SXRlbSA9IGN1cnJlbnRHcm91cFtzaWJsaW5nSW5kZXhdLCBuZXh0R3JvdXAgPSBtb2RpZmllcihjdXJyZW50R3JvdXAsIGN1cnJlbnRJdGVtKSwgbmV4dFBhbmVzID0gW1xuICAgICAgICAuLi5yb3V0ZXJQYW5lR3JvdXBzLnNsaWNlKDAsIGdyb3VwSW5kZXgpLFxuICAgICAgICBuZXh0R3JvdXAsXG4gICAgICAgIC4uLnJvdXRlclBhbmVHcm91cHMuc2xpY2UoZ3JvdXBJbmRleCArIDEpXG4gICAgICBdO1xuICAgICAgcmV0dXJuIHsgLi4ucm91dGVyU3RhdGUgfHwge30sIHBhbmVzOiBuZXh0UGFuZXMgfTtcbiAgICB9LFxuICAgIFtncm91cEluZGV4LCByb3V0ZXJQYW5lR3JvdXBzLCByb3V0ZXJTdGF0ZSwgc2libGluZ0luZGV4XVxuICApLCBtb2RpZnlDdXJyZW50R3JvdXAgPSB1c2VDYWxsYmFjayhcbiAgICAobW9kaWZpZXIpID0+IHtcbiAgICAgIGNvbnN0IG5leHRSb3V0ZXJTdGF0ZSA9IGNyZWF0ZU5leHRSb3V0ZXJTdGF0ZShtb2RpZmllcik7XG4gICAgICByZXR1cm4gc2V0VGltZW91dCgoKSA9PiBuYXZpZ2F0ZShuZXh0Um91dGVyU3RhdGUpLCAwKSwgbmV4dFJvdXRlclN0YXRlO1xuICAgIH0sXG4gICAgW2NyZWF0ZU5leHRSb3V0ZXJTdGF0ZSwgbmF2aWdhdGVdXG4gICksIGNyZWF0ZVBhdGhXaXRoUGFyYW1zID0gdXNlQ2FsbGJhY2soXG4gICAgKG5leHRQYXJhbXMpID0+IHtcbiAgICAgIGNvbnN0IG5leHRSb3V0ZXJTdGF0ZSA9IGNyZWF0ZU5leHRSb3V0ZXJTdGF0ZSgoc2libGluZ3MsIGl0ZW0pID0+IFtcbiAgICAgICAgLi4uc2libGluZ3Muc2xpY2UoMCwgc2libGluZ0luZGV4KSxcbiAgICAgICAgeyAuLi5pdGVtLCBwYXJhbXM6IG5leHRQYXJhbXMgfSxcbiAgICAgICAgLi4uc2libGluZ3Muc2xpY2Uoc2libGluZ0luZGV4ICsgMSlcbiAgICAgIF0pO1xuICAgICAgcmV0dXJuIHJlc29sdmVQYXRoRnJvbVN0YXRlKG5leHRSb3V0ZXJTdGF0ZSk7XG4gICAgfSxcbiAgICBbY3JlYXRlTmV4dFJvdXRlclN0YXRlLCByZXNvbHZlUGF0aEZyb21TdGF0ZSwgc2libGluZ0luZGV4XVxuICApLCBzZXRQYXlsb2FkID0gdXNlQ2FsbGJhY2soXG4gICAgKG5leHRQYXlsb2FkKSA9PiB7XG4gICAgICBtb2RpZnlDdXJyZW50R3JvdXAoKHNpYmxpbmdzLCBpdGVtKSA9PiBbXG4gICAgICAgIC4uLnNpYmxpbmdzLnNsaWNlKDAsIHNpYmxpbmdJbmRleCksXG4gICAgICAgIHsgLi4uaXRlbSwgcGF5bG9hZDogbmV4dFBheWxvYWQgfSxcbiAgICAgICAgLi4uc2libGluZ3Muc2xpY2Uoc2libGluZ0luZGV4ICsgMSlcbiAgICAgIF0pO1xuICAgIH0sXG4gICAgW21vZGlmeUN1cnJlbnRHcm91cCwgc2libGluZ0luZGV4XVxuICApLCBzZXRQYXJhbXMgPSB1c2VDYWxsYmFjayhcbiAgICAobmV4dFBhcmFtcykgPT4ge1xuICAgICAgbW9kaWZ5Q3VycmVudEdyb3VwKChzaWJsaW5ncywgaXRlbSkgPT4gW1xuICAgICAgICAuLi5zaWJsaW5ncy5zbGljZSgwLCBzaWJsaW5nSW5kZXgpLFxuICAgICAgICB7IC4uLml0ZW0sIHBhcmFtczogbmV4dFBhcmFtcyB9LFxuICAgICAgICAuLi5zaWJsaW5ncy5zbGljZShzaWJsaW5nSW5kZXggKyAxKVxuICAgICAgXSk7XG4gICAgfSxcbiAgICBbbW9kaWZ5Q3VycmVudEdyb3VwLCBzaWJsaW5nSW5kZXhdXG4gICksIGhhbmRsZUVkaXRSZWZlcmVuY2UgPSB1c2VDYWxsYmFjayhcbiAgICAoeyBpZCwgcGFyZW50UmVmUGF0aCwgdHlwZSwgdGVtcGxhdGUgfSkgPT4ge1xuICAgICAgbmF2aWdhdGUoe1xuICAgICAgICBwYW5lczogW1xuICAgICAgICAgIC4uLnJvdXRlclBhbmVHcm91cHMuc2xpY2UoMCwgZ3JvdXBJbmRleCArIDEpLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgIHBhcmFtczogeyB0ZW1wbGF0ZTogdGVtcGxhdGUuaWQsIHBhcmVudFJlZlBhdGg6IHRvU3RyaW5nKHBhcmVudFJlZlBhdGgpLCB0eXBlIH0sXG4gICAgICAgICAgICAgIHBheWxvYWQ6IHRlbXBsYXRlLnBhcmFtc1xuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBbZ3JvdXBJbmRleCwgbmF2aWdhdGUsIHJvdXRlclBhbmVHcm91cHNdXG4gICksIGN0eCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIC8vIFplcm8tYmFzZWQgaW5kZXggKHBvc2l0aW9uKSBvZiBwYW5lLCB2aXN1YWxseVxuICAgICAgaW5kZXg6IGZsYXRJbmRleCxcbiAgICAgIC8vIFplcm8tYmFzZWQgaW5kZXggb2YgcGFuZSBncm91cCAod2l0aGluIFVSTCBzdHJ1Y3R1cmUpXG4gICAgICBncm91cEluZGV4LFxuICAgICAgLy8gWmVyby1iYXNlZCBpbmRleCBvZiBwYW5lIHdpdGhpbiBzaWJsaW5nIGdyb3VwXG4gICAgICBzaWJsaW5nSW5kZXgsXG4gICAgICAvLyBQYXlsb2FkIG9mIHRoZSBjdXJyZW50IHBhbmVcbiAgICAgIHBheWxvYWQsXG4gICAgICAvLyBQYXJhbXMgb2YgdGhlIGN1cnJlbnQgcGFuZVxuICAgICAgcGFyYW1zLFxuICAgICAgLy8gV2hldGhlciBvciBub3QgdGhlIHBhbmUgaGFzIGFueSBzaWJsaW5ncyAod2l0aGluIHRoZSBzYW1lIGdyb3VwKVxuICAgICAgaGFzR3JvdXBTaWJsaW5nczogcm91dGVyUGFuZUdyb3Vwc1tncm91cEluZGV4XSA/IHJvdXRlclBhbmVHcm91cHNbZ3JvdXBJbmRleF0ubGVuZ3RoID4gMSA6ICExLFxuICAgICAgLy8gVGhlIGxlbmd0aCBvZiB0aGUgY3VycmVudCBncm91cFxuICAgICAgZ3JvdXBMZW5ndGg6IHJvdXRlclBhbmVHcm91cHNbZ3JvdXBJbmRleF0gPyByb3V0ZXJQYW5lR3JvdXBzW2dyb3VwSW5kZXhdLmxlbmd0aCA6IDAsXG4gICAgICAvLyBDdXJyZW50IHJvdXRlciBzdGF0ZSBmb3IgdGhlIFwicGFuZXNcIiBwcm9wZXJ0eVxuICAgICAgcm91dGVyUGFuZXNTdGF0ZTogcm91dGVyUGFuZUdyb3VwcyxcbiAgICAgIC8vIEN1cnJpZWQgU3RhdGVMaW5rIHRoYXQgcGFzc2VzIHRoZSBjb3JyZWN0IHN0YXRlIGF1dG9tYXRpY2FsbHlcbiAgICAgIENoaWxkTGluayxcbiAgICAgIC8vIEN1cnJpZWQgU3RhdGVMaW5rIHRoYXQgcG9wcyBvZmYgdGhlIGxhc3QgcGFuZSBncm91cFxuICAgICAgLy8gT25seSBwYXNzIGlmIHRoaXMgaXMgbm90IHRoZSBmaXJzdCBwYW5lXG4gICAgICBCYWNrTGluazogZmxhdEluZGV4ID8gQmFja0xpbmsgOiB2b2lkIDAsXG4gICAgICAvLyBBIHNwZWNpYWxpemVkIGBDaGlsZExpbmtgIHRoYXQgdGFrZXMgaW4gdGhlIG5lZWRlZCBwcm9wcyB0byBvcGVuIGFcbiAgICAgIC8vIHJlZmVyZW5jZWQgZG9jdW1lbnQgdG8gdGhlIHJpZ2h0XG4gICAgICBSZWZlcmVuY2VDaGlsZExpbmssXG4gICAgICAvLyBTaW1pbGFyIHRvIGBSZWZlcmVuY2VDaGlsZExpbmtgIGV4cGVjdCB3aXRob3V0IHRoZSB3cmFwcGluZyBjb21wb25lbnRcbiAgICAgIGhhbmRsZUVkaXRSZWZlcmVuY2UsXG4gICAgICAvLyBDdXJyaWVkIFN0YXRlTGluayB0aGF0IHBhc3NlZCB0aGUgY29ycmVjdCBzdGF0ZSwgYnV0IG1lcmdlcyBwYXJhbXMvcGF5bG9hZFxuICAgICAgUGFyYW1ldGVyaXplZExpbmssXG4gICAgICAvLyBSZXBsYWNlcyB0aGUgY3VycmVudCBwYW5lIHdpdGggYSBuZXcgb25lXG4gICAgICByZXBsYWNlQ3VycmVudDogKG9wdHMgPSB7fSkgPT4ge1xuICAgICAgICBtb2RpZnlDdXJyZW50R3JvdXAoKCkgPT4gW1xuICAgICAgICAgIHsgaWQ6IG9wdHMuaWQgfHwgXCJcIiwgcGF5bG9hZDogb3B0cy5wYXlsb2FkLCBwYXJhbXM6IG9wdHMucGFyYW1zIHx8IHt9IH1cbiAgICAgICAgXSk7XG4gICAgICB9LFxuICAgICAgLy8gUmVtb3ZlcyB0aGUgY3VycmVudCBwYW5lIGZyb20gdGhlIGdyb3VwXG4gICAgICBjbG9zZUN1cnJlbnQ6ICgpID0+IHtcbiAgICAgICAgbW9kaWZ5Q3VycmVudEdyb3VwKFxuICAgICAgICAgIChzaWJsaW5ncywgaXRlbSkgPT4gc2libGluZ3MubGVuZ3RoID4gMSA/IHNpYmxpbmdzLmZpbHRlcigoc2libGluZykgPT4gc2libGluZyAhPT0gaXRlbSkgOiBzaWJsaW5nc1xuICAgICAgICApO1xuICAgICAgfSxcbiAgICAgIC8vIFJlbW92ZXMgYWxsIHBhbmVzIHRvIHRoZSByaWdodCBpbmNsdWRpbmcgY3VycmVudFxuICAgICAgY2xvc2VDdXJyZW50QW5kQWZ0ZXI6IChleHBhbmRMYXN0ID0gITApID0+IHtcbiAgICAgICAgZXhwYW5kTGFzdCAmJiBsYXN0UGFuZSAmJiBleHBhbmQobGFzdFBhbmUuZWxlbWVudCksIG5hdmlnYXRlKHtcbiAgICAgICAgICBwYW5lczogWy4uLnJvdXRlclBhbmVHcm91cHMuc2xpY2UoMCwgZ3JvdXBJbmRleCldXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIC8vIER1cGxpY2F0ZSB0aGUgY3VycmVudCBwYW5lLCB3aXRoIG9wdGlvbmFsIG92ZXJyaWRlcyBmb3IgcGF5bG9hZCwgcGFyYW1ldGVyc1xuICAgICAgZHVwbGljYXRlQ3VycmVudDogKG9wdGlvbnMpID0+IHtcbiAgICAgICAgbW9kaWZ5Q3VycmVudEdyb3VwKChzaWJsaW5ncywgaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGR1cGxpY2F0ZWRJdGVtID0ge1xuICAgICAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgICAgIHBheWxvYWQ6IG9wdGlvbnM/LnBheWxvYWQgfHwgaXRlbS5wYXlsb2FkLFxuICAgICAgICAgICAgcGFyYW1zOiBvcHRpb25zPy5wYXJhbXMgfHwgaXRlbS5wYXJhbXNcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAuLi5zaWJsaW5ncy5zbGljZSgwLCBzaWJsaW5nSW5kZXgpLFxuICAgICAgICAgICAgZHVwbGljYXRlZEl0ZW0sXG4gICAgICAgICAgICAuLi5zaWJsaW5ncy5zbGljZShzaWJsaW5nSW5kZXgpXG4gICAgICAgICAgXTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgLy8gU2V0IHRoZSB2aWV3IGZvciB0aGUgY3VycmVudCBwYW5lXG4gICAgICBzZXRWaWV3OiAodmlld0lkKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3RQYXJhbXMgPSBvbWl0KHBhcmFtcywgXCJ2aWV3XCIpO1xuICAgICAgICByZXR1cm4gc2V0UGFyYW1zKHZpZXdJZCA/IHsgLi4ucmVzdFBhcmFtcywgdmlldzogdmlld0lkIH0gOiByZXN0UGFyYW1zKTtcbiAgICAgIH0sXG4gICAgICAvLyBTZXQgdGhlIHBhcmFtZXRlcnMgZm9yIHRoZSBjdXJyZW50IHBhbmVcbiAgICAgIHNldFBhcmFtcyxcbiAgICAgIC8vIFNldCB0aGUgcGF5bG9hZCBmb3IgdGhlIGN1cnJlbnQgcGFuZVxuICAgICAgc2V0UGF5bG9hZCxcbiAgICAgIC8vIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgcGF0aCB3aXRoIHRoZSBnaXZlbiBwYXJhbWV0ZXJzXG4gICAgICBjcmVhdGVQYXRoV2l0aFBhcmFtcyxcbiAgICAgIC8vIFByb3hpZWQgbmF2aWdhdGlvbiB0byBhIGdpdmVuIGludGVudC4gQ29uc2lkZXIganVzdCBleHBvc2luZyBgcm91dGVyYCBpbnN0ZWFkP1xuICAgICAgbmF2aWdhdGVJbnRlbnRcbiAgICB9KSxcbiAgICBbXG4gICAgICBmbGF0SW5kZXgsXG4gICAgICBncm91cEluZGV4LFxuICAgICAgc2libGluZ0luZGV4LFxuICAgICAgcGF5bG9hZCxcbiAgICAgIHBhcmFtcyxcbiAgICAgIHJvdXRlclBhbmVHcm91cHMsXG4gICAgICBoYW5kbGVFZGl0UmVmZXJlbmNlLFxuICAgICAgc2V0UGFyYW1zLFxuICAgICAgc2V0UGF5bG9hZCxcbiAgICAgIGNyZWF0ZVBhdGhXaXRoUGFyYW1zLFxuICAgICAgbmF2aWdhdGVJbnRlbnQsXG4gICAgICBtb2RpZnlDdXJyZW50R3JvdXAsXG4gICAgICBsYXN0UGFuZSxcbiAgICAgIG5hdmlnYXRlLFxuICAgICAgZXhwYW5kXG4gICAgXVxuICApO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChQYW5lUm91dGVyQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogY3R4LCBjaGlsZHJlbiB9KTtcbn1cbmNsYXNzIFBhbmVSZXNvbHV0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNhdXNlO1xuICBjb250ZXh0O1xuICBoZWxwSWQ7XG4gIGNvbnN0cnVjdG9yKHsgbWVzc2FnZSwgY29udGV4dCwgaGVscElkLCBjYXVzZSB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSksIHRoaXMubmFtZSA9IFwiUGFuZVJlc29sdXRpb25FcnJvclwiLCB0aGlzLmNvbnRleHQgPSBjb250ZXh0LCB0aGlzLmhlbHBJZCA9IGhlbHBJZCwgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICB9XG59XG5jb25zdCByYW5kb21JZENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBhc3NpZ25JZChvYmopIHtcbiAgY29uc3QgY2FjaGVkVmFsdWUgPSByYW5kb21JZENhY2hlLmdldChvYmopO1xuICBpZiAoY2FjaGVkVmFsdWUpIHJldHVybiBjYWNoZWRWYWx1ZTtcbiAgY29uc3QgaWQgPSBuYW5vaWQoKTtcbiAgcmV0dXJuIHJhbmRvbUlkQ2FjaGUuc2V0KG9iaiwgaWQpLCBpZDtcbn1cbmNvbnN0IGlzUHJvbWlzZSA9ICh0aGluZykgPT4gISF0aGluZyAmJiB0eXBlb2YgdGhpbmc/LnRoZW4gPT0gXCJmdW5jdGlvblwiLCBpc1NlcmlhbGl6YWJsZSA9ICh0aGluZykgPT4gaXNSZWNvcmQodGhpbmcpID8gdHlwZW9mIHRoaW5nLnNlcmlhbGl6ZSA9PSBcImZ1bmN0aW9uXCIgOiAhMSwgcmV0aHJvd1dpdGhQYW5lUmVzb2x1dGlvbkVycm9ycyA9IChuZXh0KSA9PiAodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCkgPT4ge1xuICB0cnkge1xuICAgIHJldHVybiBuZXh0KHVucmVzb2x2ZWRQYW5lLCBjb250ZXh0LCBmbGF0SW5kZXgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgZSBpbnN0YW5jZW9mIFBhbmVSZXNvbHV0aW9uRXJyb3IgPyBlIDogbmV3IFBhbmVSZXNvbHV0aW9uRXJyb3Ioe1xuICAgICAgbWVzc2FnZTogdHlwZW9mIGU/Lm1lc3NhZ2UgPT0gXCJzdHJpbmdcIiA/IGUubWVzc2FnZSA6IFwiXCIsXG4gICAgICBjb250ZXh0LFxuICAgICAgY2F1c2U6IGVcbiAgICB9KTtcbiAgfVxufSwgd3JhcFdpdGhQdWJsaXNoUmVwbGF5ID0gKG5leHQpID0+ICguLi5hcmdzKSA9PiBuZXh0KC4uLmFyZ3MpLnBpcGUoXG4gIC8vIG5lZWQgdG8gYWRkIHB1Ymxpc2hSZXBsYXkgKyByZWZDb3VudCB0byBlbnN1cmUgbmV3IHN1YnNjcmliZXJzIGFsd2F5c1xuICAvLyBnZXQgYW4gZW1pc3Npb24uIHdpdGhvdXQgdGhpcywgbWVtb2l6ZWQgb2JzZXJ2YWJsZXMgbWF5IGdldCBzdHVja1xuICAvLyB3YWl0aW5nIGZvciB0aGVpciBmaXJzdCBlbWlzc2lvbnMgcmVzdWx0aW5nIGluIGEgbG9hZGluZyBwYW5lXG4gIHB1Ymxpc2hSZXBsYXkoMSksXG4gIHJlZkNvdW50KClcbik7XG5mdW5jdGlvbiBjcmVhdGVQYW5lUmVzb2x2ZXIobWlkZGxld2FyZSkge1xuICBjb25zdCByZXNvbHZlUGFuZSA9IHJldGhyb3dXaXRoUGFuZVJlc29sdXRpb25FcnJvcnMoXG4gICAgd3JhcFdpdGhQdWJsaXNoUmVwbGF5KFxuICAgICAgbWlkZGxld2FyZSgodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCkgPT4ge1xuICAgICAgICBpZiAoIXVucmVzb2x2ZWRQYW5lKVxuICAgICAgICAgIHRocm93IG5ldyBQYW5lUmVzb2x1dGlvbkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiUGFuZSByZXR1cm5lZCBubyBjaGlsZFwiLFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIGhlbHBJZDogXCJzdHJ1Y3R1cmUtaXRlbS1yZXR1cm5lZC1uby1jaGlsZFwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpc1Byb21pc2UodW5yZXNvbHZlZFBhbmUpIHx8IGlzT2JzZXJ2YWJsZSh1bnJlc29sdmVkUGFuZSkgPyBmcm9tKHVucmVzb2x2ZWRQYW5lKS5waXBlKFxuICAgICAgICAgIHN3aXRjaE1hcCgocmVzdWx0KSA9PiByZXNvbHZlUGFuZShyZXN1bHQsIGNvbnRleHQsIGZsYXRJbmRleCkpXG4gICAgICAgICkgOiBpc1NlcmlhbGl6YWJsZSh1bnJlc29sdmVkUGFuZSkgPyByZXNvbHZlUGFuZSh1bnJlc29sdmVkUGFuZS5zZXJpYWxpemUoY29udGV4dCksIGNvbnRleHQsIGZsYXRJbmRleCkgOiB0eXBlb2YgdW5yZXNvbHZlZFBhbmUgPT0gXCJmdW5jdGlvblwiID8gcmVzb2x2ZVBhbmUodW5yZXNvbHZlZFBhbmUoY29udGV4dC5pZCwgY29udGV4dCksIGNvbnRleHQsIGZsYXRJbmRleCkgOiBvZih1bnJlc29sdmVkUGFuZSk7XG4gICAgICB9KVxuICAgIClcbiAgKTtcbiAgcmV0dXJuIHJlc29sdmVQYW5lO1xufVxuY29uc3QgYmluZENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBtZW1vQmluZChvYmosIG1ldGhvZEtleSkge1xuICBjb25zdCBib3VuZE1ldGhvZHMgPSBiaW5kQ2FjaGUuZ2V0KG9iaikgfHwgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgaWYgKGJvdW5kTWV0aG9kcykge1xuICAgIGNvbnN0IGJvdW5kMiA9IGJvdW5kTWV0aG9kcy5nZXQobWV0aG9kS2V5KTtcbiAgICBpZiAoYm91bmQyKSByZXR1cm4gYm91bmQyO1xuICB9XG4gIGNvbnN0IG1ldGhvZCA9IG9ialttZXRob2RLZXldO1xuICBpZiAodHlwZW9mIG1ldGhvZCAhPSBcImZ1bmN0aW9uXCIpXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEV4cGVjdGVkIHByb3BlcnR5IFxcYCR7bWV0aG9kS2V5fVxcYCB0byBiZSBhIGZ1bmN0aW9uIGJ1dCBnb3QgJHt0eXBlb2YgbWV0aG9kfSBpbnN0ZWFkLmBcbiAgICApO1xuICBjb25zdCBib3VuZCA9IG1ldGhvZC5iaW5kKG9iaik7XG4gIHJldHVybiBib3VuZE1ldGhvZHMuc2V0KG1ldGhvZEtleSwgYm91bmQpLCBiaW5kQ2FjaGUuc2V0KG9iaiwgYm91bmRNZXRob2RzKSwgYm91bmQ7XG59XG5hc3luYyBmdW5jdGlvbiByZXNvbHZlSW50ZW50KG9wdGlvbnMpIHtcbiAgY29uc3QgcmVzb2x2ZWRQYW5lQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLCByZXNvbHZlUGFuZSA9IGNyZWF0ZVBhbmVSZXNvbHZlcigobmV4dEZuKSA9PiAodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCkgPT4ge1xuICAgIGNvbnN0IGtleSA9IHVucmVzb2x2ZWRQYW5lICYmIGAke2Fzc2lnbklkKHVucmVzb2x2ZWRQYW5lKX0tJHtjb250ZXh0LnBhdGguam9pbihcIl9fXCIpfWAsIGNhY2hlZFJlc29sdmVkUGFuZSA9IGtleSAmJiByZXNvbHZlZFBhbmVDYWNoZS5nZXQoa2V5KTtcbiAgICBpZiAoY2FjaGVkUmVzb2x2ZWRQYW5lKSByZXR1cm4gY2FjaGVkUmVzb2x2ZWRQYW5lO1xuICAgIGNvbnN0IHJlc3VsdCA9IG5leHRGbih1bnJlc29sdmVkUGFuZSwgY29udGV4dCwgZmxhdEluZGV4KTtcbiAgICByZXR1cm4ga2V5ICYmIHJlc29sdmVkUGFuZUNhY2hlLnNldChrZXksIHJlc3VsdCksIHJlc3VsdDtcbiAgfSksIGZhbGxiYWNrRWRpdG9yUGFuZXMgPSBbXG4gICAgW1xuICAgICAge1xuICAgICAgICBpZDogYF9fZWRpdF9fJHtvcHRpb25zLnBhcmFtcy5pZH1gLFxuICAgICAgICBwYXJhbXM6IHsgLi4ub21pdChvcHRpb25zLnBhcmFtcywgW1wiaWRcIl0pLCB0eXBlOiBvcHRpb25zLnBhcmFtcy50eXBlIH0sXG4gICAgICAgIHBheWxvYWQ6IG9wdGlvbnMucGF5bG9hZFxuICAgICAgfVxuICAgIF1cbiAgXTtcbiAgYXN5bmMgZnVuY3Rpb24gdHJhdmVyc2Uoe1xuICAgIGN1cnJlbnRJZCxcbiAgICBmbGF0SW5kZXgsXG4gICAgaW50ZW50LFxuICAgIHBhcmFtcyxcbiAgICBwYXJlbnQ6IHBhcmVudDIsXG4gICAgcGF0aCxcbiAgICBwYXlsb2FkLFxuICAgIHVucmVzb2x2ZWRQYW5lLFxuICAgIGxldmVsSW5kZXgsXG4gICAgc3RydWN0dXJlQ29udGV4dFxuICB9KSB7XG4gICAgaWYgKCF1bnJlc29sdmVkUGFuZSkgcmV0dXJuIFtdO1xuICAgIGNvbnN0IHsgaWQ6IHRhcmdldElkLCB0eXBlOiBzY2hlbWFUeXBlTmFtZSwgLi4ub3RoZXJQYXJhbXMgfSA9IHBhcmFtcywgcmVzb2x2ZWRQYW5lID0gYXdhaXQgZmlyc3RWYWx1ZUZyb20ocmVzb2x2ZVBhbmUodW5yZXNvbHZlZFBhbmUsIHtcbiAgICAgIGlkOiBjdXJyZW50SWQsXG4gICAgICBzcGxpdEluZGV4OiAwLFxuICAgICAgcGFyZW50OiBwYXJlbnQyLFxuICAgICAgcGF0aCxcbiAgICAgIGluZGV4OiBmbGF0SW5kZXgsXG4gICAgICBwYXJhbXM6IHt9LFxuICAgICAgcGF5bG9hZDogdm9pZCAwLFxuICAgICAgc3RydWN0dXJlQ29udGV4dFxuICAgIH0sIGZsYXRJbmRleCkpO1xuICAgIHJldHVybiByZXNvbHZlZFBhbmUudHlwZSA9PT0gXCJkb2N1bWVudFwiICYmIHJlc29sdmVkUGFuZS5pZCA9PT0gdGFyZ2V0SWQgPyBbXG4gICAgICB7XG4gICAgICAgIHBhbmVzOiBbXG4gICAgICAgICAgLi4ucGF0aC5zbGljZSgwLCBwYXRoLmxlbmd0aCAtIDEpLm1hcCgoaSkgPT4gW3sgaWQ6IGkgfV0pLFxuICAgICAgICAgIFt7IGlkOiB0YXJnZXRJZCwgcGFyYW1zOiBvdGhlclBhcmFtcywgcGF5bG9hZCB9XVxuICAgICAgICBdLFxuICAgICAgICBkZXB0aEluZGV4OiBwYXRoLmxlbmd0aCxcbiAgICAgICAgbGV2ZWxJbmRleFxuICAgICAgfVxuICAgIF0gOiAoXG4gICAgICAvLyBpZiB0aGUgcmVzb2x2ZSBwYW5lJ3MgYGNhbkhhbmRsZUludGVudGAgcmV0dXJucyB0cnVlLCB0aGVuIHJlc29sdmVcbiAgICAgIHJlc29sdmVkUGFuZS5jYW5IYW5kbGVJbnRlbnQ/LihpbnRlbnQsIHBhcmFtcywge1xuICAgICAgICBwYW5lOiByZXNvbHZlZFBhbmUsXG4gICAgICAgIGluZGV4OiBmbGF0SW5kZXhcbiAgICAgIH0pIHx8IC8vIGlmIHRoZSBwYW5lJ3MgYGNhbkhhbmRsZUludGVudGAgZGlkIG5vdCByZXR1cm4gdHJ1ZSwgdGhlbiBtYXRjaCBhZ2FpbnN0XG4gICAgICAvLyB0aGlzIGRlZmF1bHQgY2FzZS4gd2Ugd2lsbCByZXNvbHZlIHRoZSBpbnRlbnQgaWY6XG4gICAgICByZXNvbHZlZFBhbmUudHlwZSA9PT0gXCJkb2N1bWVudExpc3RcIiAmJiAvLyAxLiB0aGUgc2NoZW1hIHR5cGUgbWF0Y2hlcyAodGhpcyByZXF1aXJlZCBmb3IgdGhlIGRvY3VtZW50IHRvIHJlbmRlcilcbiAgICAgIHJlc29sdmVkUGFuZS5zY2hlbWFUeXBlTmFtZSA9PT0gc2NoZW1hVHlwZU5hbWUgJiYgLy8gMi4gdGhlIGZpbHRlciBpcyB0aGUgZGVmYXVsdCBmaWx0ZXIuXG4gICAgICAvL1xuICAgICAgLy8gTk9URTogdGhpcyBjYXNlIGlzIHRvIHByZXZlbnQgZmFsc2UgcG9zaXRpdmUgbWF0Y2hlcyB3aGVyZSB0aGUgdXNlclxuICAgICAgLy8gaGFzIGNvbmZpZ3VyZWQgYSBtb3JlIHNwZWNpZmljIGZpbHRlciBmb3IgYSBwYXJ0aWN1bGFyIHR5cGUuIEluIHRoYXRcbiAgICAgIC8vIGNhc2UsIHRoZSB1c2VyIGNhbiBpbXBsZW1lbnQgdGhlaXIgb3duIGBjYW5IYW5kbGVJbnRlbnRgIGZ1bmN0aW9uXG4gICAgICByZXNvbHZlZFBhbmUub3B0aW9ucy5maWx0ZXIgPT09IFwiX3R5cGUgPT0gJHR5cGVcIiA/IFtcbiAgICAgICAge1xuICAgICAgICAgIHBhbmVzOiBbXG4gICAgICAgICAgICAvLyBtYXAgdGhlIGN1cnJlbnQgcGF0aCB0byByb3V0ZXIgcGFuZXNcbiAgICAgICAgICAgIC4uLnBhdGgubWFwKChpZCkgPT4gW3sgaWQgfV0pLFxuICAgICAgICAgICAgLy8gdGhlbiBhdWdtZW50IHdpdGggdGhlIGludGVudHMgSURzIGFuZCBwYXJhbXNcbiAgICAgICAgICAgIFt7IGlkOiBwYXJhbXMuaWQsIHBhcmFtczogb3RoZXJQYXJhbXMsIHBheWxvYWQgfV1cbiAgICAgICAgICBdLFxuICAgICAgICAgIGRlcHRoSW5kZXg6IHBhdGgubGVuZ3RoLFxuICAgICAgICAgIGxldmVsSW5kZXhcbiAgICAgICAgfVxuICAgICAgXSA6IHJlc29sdmVkUGFuZS50eXBlID09PSBcImxpc3RcIiAmJiByZXNvbHZlZFBhbmUuY2hpbGQgJiYgcmVzb2x2ZWRQYW5lLml0ZW1zID8gKGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICByZXNvbHZlZFBhbmUuaXRlbXMubWFwKChpdGVtLCBuZXh0TGV2ZWxJbmRleCkgPT4gaXRlbS50eXBlID09PSBcImRpdmlkZXJcIiA/IFByb21pc2UucmVzb2x2ZShbXSkgOiB0cmF2ZXJzZSh7XG4gICAgICAgICAgY3VycmVudElkOiBpdGVtLl9pZCB8fCBpdGVtLmlkLFxuICAgICAgICAgIGZsYXRJbmRleDogZmxhdEluZGV4ICsgMSxcbiAgICAgICAgICBpbnRlbnQsXG4gICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgIHBhcmVudDogcmVzb2x2ZWRQYW5lLFxuICAgICAgICAgIHBhdGg6IFsuLi5wYXRoLCBpdGVtLmlkXSxcbiAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgIHVucmVzb2x2ZWRQYW5lOiB0eXBlb2YgcmVzb2x2ZWRQYW5lLmNoaWxkID09IFwiZnVuY3Rpb25cIiA/IG1lbW9CaW5kKHJlc29sdmVkUGFuZSwgXCJjaGlsZFwiKSA6IHJlc29sdmVkUGFuZS5jaGlsZCxcbiAgICAgICAgICBsZXZlbEluZGV4OiBuZXh0TGV2ZWxJbmRleCxcbiAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgIH0pKVxuICAgICAgKSkuZmxhdCgpIDogW11cbiAgICApO1xuICB9XG4gIGNvbnN0IGNsb3Nlc3RQYW5lVG9Sb290ID0gKGF3YWl0IHRyYXZlcnNlKHtcbiAgICBjdXJyZW50SWQ6IFwicm9vdFwiLFxuICAgIGZsYXRJbmRleDogMCxcbiAgICBsZXZlbEluZGV4OiAwLFxuICAgIGludGVudDogb3B0aW9ucy5pbnRlbnQsXG4gICAgcGFyYW1zOiBvcHRpb25zLnBhcmFtcyxcbiAgICBwYXJlbnQ6IG51bGwsXG4gICAgcGF0aDogW10sXG4gICAgcGF5bG9hZDogb3B0aW9ucy5wYXlsb2FkLFxuICAgIHVucmVzb2x2ZWRQYW5lOiBvcHRpb25zLnJvb3RQYW5lTm9kZSxcbiAgICBzdHJ1Y3R1cmVDb250ZXh0OiBvcHRpb25zLnN0cnVjdHVyZUNvbnRleHRcbiAgfSkpLnNvcnQoKGEsIGIpID0+IGEuZGVwdGhJbmRleCA9PT0gYi5kZXB0aEluZGV4ID8gYS5sZXZlbEluZGV4IC0gYi5sZXZlbEluZGV4IDogYS5kZXB0aEluZGV4IC0gYi5kZXB0aEluZGV4KVswXTtcbiAgcmV0dXJuIGNsb3Nlc3RQYW5lVG9Sb290ID8gY2xvc2VzdFBhbmVUb1Jvb3QucGFuZXMgOiBmYWxsYmFja0VkaXRvclBhbmVzO1xufVxuY29uc3QgZmFsbGJhY2tFZGl0b3JDaGlsZCA9IChub2RlSWQsIGNvbnRleHQpID0+IHtcbiAgY29uc3QgaWQgPSBub2RlSWQucmVwbGFjZSgvXl9fZWRpdF9fLywgXCJcIiksIHtcbiAgICBwYXJhbXMsXG4gICAgcGF5bG9hZCxcbiAgICBzdHJ1Y3R1cmVDb250ZXh0OiB7IHJlc29sdmVEb2N1bWVudE5vZGUgfVxuICB9ID0gY29udGV4dCwgeyB0eXBlLCB0ZW1wbGF0ZSB9ID0gcGFyYW1zO1xuICBpZiAoIXR5cGUpXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYERvY3VtZW50IHR5cGUgZm9yIGRvY3VtZW50IHdpdGggSUQgJHtpZH0gd2FzIG5vdCBwcm92aWRlZCBpbiB0aGUgcm91dGVyIHBhcmFtcy5gXG4gICAgKTtcbiAgbGV0IGRlZmF1bHREb2N1bWVudEJ1aWxkZXIgPSByZXNvbHZlRG9jdW1lbnROb2RlKHsgc2NoZW1hVHlwZTogdHlwZSwgZG9jdW1lbnRJZDogaWQgfSkuaWQoXCJlZGl0b3JcIik7XG4gIHJldHVybiB0ZW1wbGF0ZSAmJiAoZGVmYXVsdERvY3VtZW50QnVpbGRlciA9IGRlZmF1bHREb2N1bWVudEJ1aWxkZXIuaW5pdGlhbFZhbHVlVGVtcGxhdGUoXG4gICAgdGVtcGxhdGUsXG4gICAgcGF5bG9hZFxuICApKSwgZGVmYXVsdERvY3VtZW50QnVpbGRlci5zZXJpYWxpemUoKTtcbn07XG5mdW5jdGlvbiBoYXNoQ29udGV4dChjb250ZXh0KSB7XG4gIHJldHVybiBgY29udGV4dEhhc2goJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgaWQ6IGNvbnRleHQuaWQsXG4gICAgcGFyZW50SWQ6IHBhcmVudCAmJiBhc3NpZ25JZChwYXJlbnQpLFxuICAgIHBhdGg6IGNvbnRleHQucGF0aCxcbiAgICBpbmRleDogY29udGV4dC5pbmRleCxcbiAgICBzcGxpdEluZGV4OiBjb250ZXh0LnNwbGl0SW5kZXgsXG4gICAgc2VyaWFsaXplT3B0aW9uc0luZGV4OiBjb250ZXh0LnNlcmlhbGl6ZU9wdGlvbnM/LmluZGV4LFxuICAgIHNlcmlhbGl6ZU9wdGlvbnNQYXRoOiBjb250ZXh0LnNlcmlhbGl6ZU9wdGlvbnM/LnBhdGhcbiAgfSl9KWA7XG59XG5jb25zdCBoYXNoUmVzb2x2ZWRQYW5lTWV0YSA9IChtZXRhKSA9PiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSB7XG4gICAgdHlwZTogbWV0YS50eXBlLFxuICAgIGlkOiBtZXRhLnJvdXRlclBhbmVTaWJsaW5nLmlkLFxuICAgIHBhcmFtczogbWV0YS5yb3V0ZXJQYW5lU2libGluZy5wYXJhbXMgfHwge30sXG4gICAgcGF5bG9hZDogbWV0YS5yb3V0ZXJQYW5lU2libGluZy5wYXlsb2FkIHx8IG51bGwsXG4gICAgZmxhdEluZGV4OiBtZXRhLmZsYXRJbmRleCxcbiAgICBncm91cEluZGV4OiBtZXRhLmdyb3VwSW5kZXgsXG4gICAgc2libGluZ0luZGV4OiBtZXRhLnNpYmxpbmdJbmRleCxcbiAgICBwYXRoOiBtZXRhLnBhdGgsXG4gICAgcGFuZU5vZGU6IG1ldGEudHlwZSA9PT0gXCJyZXNvbHZlZE1ldGFcIiA/IGFzc2lnbklkKG1ldGEucGFuZU5vZGUpIDogbnVsbFxuICB9O1xuICByZXR1cm4gYG1ldGFIYXNoKCR7SlNPTi5zdHJpbmdpZnkobm9ybWFsaXplZCl9KWA7XG59O1xuZnVuY3Rpb24gcmVzb2x2ZVBhbmVUcmVlKHtcbiAgdW5yZXNvbHZlZFBhbmUsXG4gIGZsYXR0ZW5lZFJvdXRlclBhbmVzLFxuICBwYXJlbnQ6IHBhcmVudDIsXG4gIHBhdGgsXG4gIHJlc29sdmVQYW5lLFxuICBzdHJ1Y3R1cmVDb250ZXh0XG59KSB7XG4gIGNvbnN0IFtjdXJyZW50LCAuLi5yZXN0XSA9IGZsYXR0ZW5lZFJvdXRlclBhbmVzLCBuZXh0ID0gcmVzdFswXSwgY29udGV4dCA9IHtcbiAgICBpZDogY3VycmVudC5yb3V0ZXJQYW5lU2libGluZy5pZCxcbiAgICBzcGxpdEluZGV4OiBjdXJyZW50LnNpYmxpbmdJbmRleCxcbiAgICBwYXJlbnQ6IHBhcmVudDIsXG4gICAgcGF0aDogWy4uLnBhdGgsIGN1cnJlbnQucm91dGVyUGFuZVNpYmxpbmcuaWRdLFxuICAgIGluZGV4OiBjdXJyZW50LmZsYXRJbmRleCxcbiAgICBwYXJhbXM6IGN1cnJlbnQucm91dGVyUGFuZVNpYmxpbmcucGFyYW1zIHx8IHt9LFxuICAgIHBheWxvYWQ6IGN1cnJlbnQucm91dGVyUGFuZVNpYmxpbmcucGF5bG9hZCxcbiAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gIH07XG4gIHRyeSB7XG4gICAgcmV0dXJuIHJlc29sdmVQYW5lKHVucmVzb2x2ZWRQYW5lLCBjb250ZXh0LCBjdXJyZW50LmZsYXRJbmRleCkucGlwZShcbiAgICAgIC8vIHRoaXMgc3dpdGNoIG1hcCByZWNlaXZlcyBhIHJlc29sdmVkIHBhbmVcbiAgICAgIHN3aXRjaE1hcCgocGFuZU5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVzb2x2ZWRQYW5lTWV0YSA9IHtcbiAgICAgICAgICB0eXBlOiBcInJlc29sdmVkTWV0YVwiLFxuICAgICAgICAgIC4uLmN1cnJlbnQsXG4gICAgICAgICAgcGFuZU5vZGUsXG4gICAgICAgICAgcGF0aDogY29udGV4dC5wYXRoXG4gICAgICAgIH0sIGxvYWRpbmdQYW5lcyA9IHJlc3QubWFwKChpLCByZXN0SW5kZXgpID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJsb2FkaW5nXCIsXG4gICAgICAgICAgcGF0aDogW1xuICAgICAgICAgICAgLi4uY29udGV4dC5wYXRoLFxuICAgICAgICAgICAgLi4ucmVzdC5zbGljZShyZXN0SW5kZXgpLm1hcCgoXywgY3VycmVudEluZGV4KSA9PiBgWyR7aS5mbGF0SW5kZXggKyBjdXJyZW50SW5kZXh9XWApXG4gICAgICAgICAgXSxcbiAgICAgICAgICBwYW5lTm9kZTogbnVsbCxcbiAgICAgICAgICAuLi5pXG4gICAgICAgIH0pKTtcbiAgICAgICAgaWYgKCFyZXN0Lmxlbmd0aClcbiAgICAgICAgICByZXR1cm4gb2YoW3Jlc29sdmVkUGFuZU1ldGFdKTtcbiAgICAgICAgbGV0IG5leHRTdHJlYW07XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgLyogdGhlIGZhbGxiYWNrIGVkaXRvciBjYXNlICovXG4gICAgICAgICAgbmV4dD8ucm91dGVyUGFuZVNpYmxpbmcuaWQuc3RhcnRzV2l0aChcIl9fZWRpdF9fXCIpID8gbmV4dFN0cmVhbSA9IHJlc29sdmVQYW5lVHJlZSh7XG4gICAgICAgICAgICB1bnJlc29sdmVkUGFuZTogZmFsbGJhY2tFZGl0b3JDaGlsZCxcbiAgICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiByZXN0LFxuICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQyLFxuICAgICAgICAgICAgcGF0aDogY29udGV4dC5wYXRoLFxuICAgICAgICAgICAgcmVzb2x2ZVBhbmUsXG4gICAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgICAgfSkgOiBjdXJyZW50Lmdyb3VwSW5kZXggPT09IG5leHQ/Lmdyb3VwSW5kZXggPyBuZXh0U3RyZWFtID0gcmVzb2x2ZVBhbmVUcmVlKHtcbiAgICAgICAgICAgIHVucmVzb2x2ZWRQYW5lLFxuICAgICAgICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXM6IHJlc3QsXG4gICAgICAgICAgICBwYXJlbnQ6IHBhcmVudDIsXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgcmVzb2x2ZVBhbmUsXG4gICAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgICAgfSkgOiBuZXh0U3RyZWFtID0gcmVzb2x2ZVBhbmVUcmVlKHtcbiAgICAgICAgICAgIHVucmVzb2x2ZWRQYW5lOiB0eXBlb2YgcGFuZU5vZGUuY2hpbGQgPT0gXCJmdW5jdGlvblwiID8gbWVtb0JpbmQocGFuZU5vZGUsIFwiY2hpbGRcIikgOiBwYW5lTm9kZS5jaGlsZCxcbiAgICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiByZXN0LFxuICAgICAgICAgICAgcGFyZW50OiBwYW5lTm9kZSxcbiAgICAgICAgICAgIHBhdGg6IGNvbnRleHQucGF0aCxcbiAgICAgICAgICAgIHJlc29sdmVQYW5lLFxuICAgICAgICAgICAgc3RydWN0dXJlQ29udGV4dFxuICAgICAgICAgIH0pLCBjb25jYXQoXG4gICAgICAgICAgICAvLyB3ZSBlbWl0IHRoZSBsb2FkaW5nIHBhbmVzIGZpcnN0IGluIGEgY29uY2F0ICh0aGlzIGVtaXRzIGltbWVkaWF0ZWx5KVxuICAgICAgICAgICAgb2YoW3Jlc29sdmVkUGFuZU1ldGEsIC4uLmxvYWRpbmdQYW5lc10pLFxuICAgICAgICAgICAgLy8gdGhlbiB3aGVuZXZlciB0aGUgbmV4dCBzdHJlYW0gaXMgZG9uZSwgdGhlIHJlc3VsdHMgd2lsbCBiZSBjb21iaW5lZC5cbiAgICAgICAgICAgIG5leHRTdHJlYW0ucGlwZShtYXAoKG5leHRSZXNvbHZlZFBhbmVzKSA9PiBbcmVzb2x2ZWRQYW5lTWV0YSwgLi4ubmV4dFJlc29sdmVkUGFuZXNdKSlcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIFBhbmVSZXNvbHV0aW9uRXJyb3IgJiYgKGUuY29udGV4dCAmJiBjb25zb2xlLndhcm4oXG4gICAgICBgUGFuZSByZXNvbHV0aW9uIGVycm9yIGF0IGluZGV4ICR7ZS5jb250ZXh0LmluZGV4fSR7ZS5jb250ZXh0LnNwbGl0SW5kZXggPiAwID8gYCBmb3Igc3BsaXQgcGFuZSBpbmRleCAke2UuY29udGV4dC5zcGxpdEluZGV4fWAgOiBcIlwifTogJHtlLm1lc3NhZ2V9JHtlLmhlbHBJZCA/IGAgLSBzZWUgJHtnZW5lcmF0ZUhlbHBVcmwoZS5oZWxwSWQpfWAgOiBcIlwifWAsXG4gICAgICBlXG4gICAgKSwgZS5oZWxwSWQgPT09IFwic3RydWN0dXJlLWl0ZW0tcmV0dXJuZWQtbm8tY2hpbGRcIikpXG4gICAgICByZXR1cm4gb2YoW10pO1xuICAgIHRocm93IGU7XG4gIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVJlc29sdmVkUGFuZU5vZGVTdHJlYW0oe1xuICByb3V0ZXJQYW5lc1N0cmVhbSxcbiAgcm9vdFBhbmVOb2RlLFxuICBpbml0aWFsQ2FjaGVTdGF0ZSA9IHtcbiAgICBjYWNoZUtleXNCeUZsYXRJbmRleDogW10sXG4gICAgZmxhdHRlbmVkUm91dGVyUGFuZXM6IFtdLFxuICAgIHJlc29sdmVkUGFuZUNhY2hlOiAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLFxuICAgIHJlc29sdmVQYW5lOiAoKSA9PiBORVZFUlxuICB9LFxuICBzdHJ1Y3R1cmVDb250ZXh0XG59KSB7XG4gIHJldHVybiByb3V0ZXJQYW5lc1N0cmVhbS5waXBlKFxuICAgIC8vIGFkZCBpbiBpbXBsaWNpdCBcInJvb3RcIiByb3V0ZXIgcGFuZVxuICAgIG1hcCgocmF3Um91dGVyUGFuZXMpID0+IFtbeyBpZDogXCJyb290XCIgfV0sIC4uLnJhd1JvdXRlclBhbmVzXSksXG4gICAgLy8gY3JlYXRlIGZsYXR0ZW5lZCByb3V0ZXIgcGFuZXNcbiAgICBtYXAoKHJvdXRlclBhbmVzKSA9PiByb3V0ZXJQYW5lcy5mbGF0TWFwKFxuICAgICAgKHJvdXRlclBhbmVHcm91cCwgZ3JvdXBJbmRleCkgPT4gcm91dGVyUGFuZUdyb3VwLm1hcCgocm91dGVyUGFuZVNpYmxpbmcsIHNpYmxpbmdJbmRleCkgPT4gKHtcbiAgICAgICAgcm91dGVyUGFuZVNpYmxpbmcsXG4gICAgICAgIGdyb3VwSW5kZXgsXG4gICAgICAgIHNpYmxpbmdJbmRleFxuICAgICAgfSkpXG4gICAgKS5tYXAoKGksIGluZGV4KSA9PiAoeyAuLi5pLCBmbGF0SW5kZXg6IGluZGV4IH0pKSksXG4gICAgLy8gY2FsY3VsYXRlIGEgXCJkaWZmSW5kZXhcIiB1c2VkIGZvciBjbGVhcmluZyB0aGUgbWVtbyBjYWNoZVxuICAgIHN0YXJ0V2l0aChbXSksXG4gICAgcGFpcndpc2UoKSxcbiAgICBtYXAoKFtwcmV2LCBjdXJyXSkgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHByZXZWYWx1ZSA9IHByZXZbaV0sIGN1cnJWYWx1ZSA9IGN1cnJbaV07XG4gICAgICAgIGlmICghaXNFcXVhbChwcmV2VmFsdWUsIGN1cnJWYWx1ZSkpXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiBjdXJyLFxuICAgICAgICAgICAgZGlmZkluZGV4OiBpXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiBjdXJyLFxuICAgICAgICBkaWZmSW5kZXg6IGN1cnIubGVuZ3RoXG4gICAgICB9O1xuICAgIH0pLFxuICAgIC8vIGNyZWF0ZSB0aGUgbWVtb2l6ZWQgYHJlc29sdmVQYW5lYCBmdW5jdGlvbiBhbmQgbWFuYWdlIHRoZSBtZW1vIGNhY2hlXG4gICAgc2NhbigoYWNjLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCB7IGNhY2hlS2V5c0J5RmxhdEluZGV4LCByZXNvbHZlZFBhbmVDYWNoZSB9ID0gYWNjLCB7IGZsYXR0ZW5lZFJvdXRlclBhbmVzLCBkaWZmSW5kZXggfSA9IG5leHQsIGJlZm9yZURpZmZJbmRleCA9IGNhY2hlS2V5c0J5RmxhdEluZGV4LnNsaWNlKDAsIGRpZmZJbmRleCArIDEpLCBhZnRlckRpZmZJbmRleCA9IGNhY2hlS2V5c0J5RmxhdEluZGV4LnNsaWNlKGRpZmZJbmRleCArIDEpLCBrZXlzVG9LZWVwID0gbmV3IFNldChiZWZvcmVEaWZmSW5kZXguZmxhdE1hcCgoa2V5U2V0KSA9PiBBcnJheS5mcm9tKGtleVNldCkpKSwga2V5c1RvRGVsZXRlID0gYWZ0ZXJEaWZmSW5kZXguZmxhdE1hcCgoa2V5U2V0KSA9PiBBcnJheS5mcm9tKGtleVNldCkpLmZpbHRlcigoa2V5KSA9PiAha2V5c1RvS2VlcC5oYXMoa2V5KSk7XG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzVG9EZWxldGUpXG4gICAgICAgIHJlc29sdmVkUGFuZUNhY2hlLmRlbGV0ZShrZXkpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXMsXG4gICAgICAgIGNhY2hlS2V5c0J5RmxhdEluZGV4LFxuICAgICAgICByZXNvbHZlZFBhbmVDYWNoZSxcbiAgICAgICAgcmVzb2x2ZVBhbmU6IGNyZWF0ZVBhbmVSZXNvbHZlcigobmV4dEZuKSA9PiAodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGtleSA9IHVucmVzb2x2ZWRQYW5lICYmIGAke2Fzc2lnbklkKHVucmVzb2x2ZWRQYW5lKX0tJHtoYXNoQ29udGV4dChjb250ZXh0KX1gLCBjYWNoZWRSZXNvbHZlZFBhbmUgPSBrZXkgJiYgcmVzb2x2ZWRQYW5lQ2FjaGUuZ2V0KGtleSk7XG4gICAgICAgICAgaWYgKGNhY2hlZFJlc29sdmVkUGFuZSkgcmV0dXJuIGNhY2hlZFJlc29sdmVkUGFuZTtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0Rm4odW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCk7XG4gICAgICAgICAgaWYgKCFrZXkpIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgY29uc3QgY2FjaGVLZXlTZXQgPSBjYWNoZUtleXNCeUZsYXRJbmRleFtmbGF0SW5kZXhdIHx8IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgICAgICAgcmV0dXJuIGNhY2hlS2V5U2V0LmFkZChrZXkpLCBjYWNoZUtleXNCeUZsYXRJbmRleFtmbGF0SW5kZXhdID0gY2FjaGVLZXlTZXQsIHJlc29sdmVkUGFuZUNhY2hlLnNldChrZXksIHJlc3VsdCksIHJlc3VsdDtcbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfSwgaW5pdGlhbENhY2hlU3RhdGUpLFxuICAgIC8vIHJ1biB0aGUgbWVtb2l6ZWQsIHJlY3Vyc2l2ZSByZXNvbHZpbmdcbiAgICBzd2l0Y2hNYXAoXG4gICAgICAoeyBmbGF0dGVuZWRSb3V0ZXJQYW5lcywgcmVzb2x2ZVBhbmUgfSkgPT4gcmVzb2x2ZVBhbmVUcmVlKHtcbiAgICAgICAgdW5yZXNvbHZlZFBhbmU6IHJvb3RQYW5lTm9kZSxcbiAgICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXMsXG4gICAgICAgIHBhcmVudDogbnVsbCxcbiAgICAgICAgcGF0aDogW10sXG4gICAgICAgIHJlc29sdmVQYW5lLFxuICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICB9KVxuICAgIClcbiAgKS5waXBlKFxuICAgIC8vIHRoaXMgZGlmZnMgdGhlIHByZXZpb3VzIGVtaXNzaW9uIHdpdGggdGhlIGN1cnJlbnQgb25lLiBpZiB0aGVyZSBpcyBhIG5ld1xuICAgIC8vIGxvYWRpbmcgcGFuZSBhdCB0aGUgc2FtZSBwb3NpdGlvbiB3aGVyZSBhIHByZXZpb3VzIHBhbmUgYWxyZWFkeSBoYWQgYVxuICAgIC8vIHJlc29sdmVkIHZhbHVlIChsb29raW5nIGF0IHRoZSBJRHMgdG8gY29tcGFyZSksIHRoZW4gcmV0dXJuIHRoZSBwcmV2aW91c1xuICAgIC8vIHBhbmUgaW5zdGVhZCBvZiB0aGUgbG9hZGluZyBwYW5lXG4gICAgc2NhbihcbiAgICAgIChwcmV2LCBuZXh0KSA9PiBuZXh0Lm1hcCgobmV4dFBhbmUsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHByZXZQYW5lID0gcHJldltpbmRleF07XG4gICAgICAgIHJldHVybiAhcHJldlBhbmUgfHwgbmV4dFBhbmUudHlwZSAhPT0gXCJsb2FkaW5nXCIgPyBuZXh0UGFuZSA6IHByZXZQYW5lLnJvdXRlclBhbmVTaWJsaW5nLmlkID09PSBuZXh0UGFuZS5yb3V0ZXJQYW5lU2libGluZy5pZCA/IHByZXZQYW5lIDogbmV4dFBhbmU7XG4gICAgICB9KSxcbiAgICAgIFtdXG4gICAgKSxcbiAgICAvLyB0aGlzIHByZXZlbnRzIGR1cGxpY2F0ZSBlbWlzc2lvbnNcbiAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgocHJldiwgbmV4dCkgPT4ge1xuICAgICAgaWYgKHByZXYubGVuZ3RoICE9PSBuZXh0Lmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXh0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHByZXZWYWx1ZSA9IHByZXZbaV0sIG5leHRWYWx1ZSA9IG5leHRbaV07XG4gICAgICAgIGlmIChoYXNoUmVzb2x2ZWRQYW5lTWV0YShwcmV2VmFsdWUpICE9PSBoYXNoUmVzb2x2ZWRQYW5lTWV0YShuZXh0VmFsdWUpKVxuICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAhMDtcbiAgICB9KVxuICApO1xufVxuZnVuY3Rpb24gdXNlUm91dGVyUGFuZXNTdHJlYW0oKSB7XG4gIGNvbnN0IHJvdXRlclN0YXRlU3ViamVjdCA9IHVzZU1lbW8oKCkgPT4gbmV3IFJlcGxheVN1YmplY3QoMSksIFtdKSwgcm91dGVyUGFuZXMkID0gdXNlTWVtbyhcbiAgICAoKSA9PiByb3V0ZXJTdGF0ZVN1YmplY3QuYXNPYnNlcnZhYmxlKCkucGlwZShtYXAoKF9yb3V0ZXJTdGF0ZSkgPT4gX3JvdXRlclN0YXRlPy5wYW5lcyB8fCBbXSkpLFxuICAgIFtyb3V0ZXJTdGF0ZVN1YmplY3RdXG4gICksIHsgc3RhdGU6IHJvdXRlclN0YXRlIH0gPSB1c2VSb3V0ZXIoKTtcbiAgcmV0dXJuIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcm91dGVyU3RhdGVTdWJqZWN0Lm5leHQocm91dGVyU3RhdGUpO1xuICB9LCBbcm91dGVyU3RhdGUsIHJvdXRlclN0YXRlU3ViamVjdF0pLCByb3V0ZXJQYW5lcyQ7XG59XG5mdW5jdGlvbiB1c2VSZXNvbHZlZFBhbmVzKCkge1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKCk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIGNvbnN0IHsgc3RydWN0dXJlQ29udGV4dCwgcm9vdFBhbmVOb2RlIH0gPSB1c2VTdHJ1Y3R1cmVUb29sKCksIFtkYXRhLCBzZXREYXRhXSA9IHVzZVN0YXRlKHtcbiAgICBwYW5lRGF0YUl0ZW1zOiBbXSxcbiAgICByZXNvbHZlZFBhbmVzOiBbXSxcbiAgICByb3V0ZXJQYW5lczogW11cbiAgfSksIHJvdXRlclBhbmVzU3RyZWFtID0gdXNlUm91dGVyUGFuZXNTdHJlYW0oKTtcbiAgcmV0dXJuIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gY3JlYXRlUmVzb2x2ZWRQYW5lTm9kZVN0cmVhbSh7XG4gICAgICByb290UGFuZU5vZGUsXG4gICAgICByb3V0ZXJQYW5lc1N0cmVhbSxcbiAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICB9KS5waXBlKFxuICAgICAgbWFwKChyZXNvbHZlZFBhbmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHJvdXRlclBhbmVzID0gcmVzb2x2ZWRQYW5lcy5yZWR1Y2UoKGFjYywgbmV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGN1cnJlbnRHcm91cCA9IGFjY1tuZXh0Lmdyb3VwSW5kZXhdIHx8IFtdO1xuICAgICAgICAgIHJldHVybiBjdXJyZW50R3JvdXBbbmV4dC5zaWJsaW5nSW5kZXhdID0gbmV4dC5yb3V0ZXJQYW5lU2libGluZywgYWNjW25leHQuZ3JvdXBJbmRleF0gPSBjdXJyZW50R3JvdXAsIGFjYztcbiAgICAgICAgfSwgW10pLCBncm91cHNMZW4gPSByb3V0ZXJQYW5lcy5sZW5ndGgsIHBhbmVEYXRhSXRlbXMgPSByZXNvbHZlZFBhbmVzLm1hcCgocGFuZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgZ3JvdXBJbmRleCwgZmxhdEluZGV4LCBzaWJsaW5nSW5kZXgsIHJvdXRlclBhbmVTaWJsaW5nLCBwYXRoIH0gPSBwYW5lLCBpdGVtSWQgPSByb3V0ZXJQYW5lU2libGluZy5pZCwgbmV4dEdyb3VwID0gcm91dGVyUGFuZXNbZ3JvdXBJbmRleCArIDFdO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhY3RpdmU6IGdyb3VwSW5kZXggPT09IGdyb3Vwc0xlbiAtIDIsXG4gICAgICAgICAgICBjaGlsZEl0ZW1JZDogbmV4dEdyb3VwPy5bMF0uaWQgPz8gbnVsbCxcbiAgICAgICAgICAgIGluZGV4OiBmbGF0SW5kZXgsXG4gICAgICAgICAgICBpdGVtSWQ6IHJvdXRlclBhbmVTaWJsaW5nLmlkLFxuICAgICAgICAgICAgZ3JvdXBJbmRleCxcbiAgICAgICAgICAgIGtleTogYCR7cGFuZS50eXBlID09PSBcImxvYWRpbmdcIiA/IFwidW5rbm93blwiIDogcGFuZS5wYW5lTm9kZS5pZH0tJHtpdGVtSWR9LSR7c2libGluZ0luZGV4fWAsXG4gICAgICAgICAgICBwYW5lOiBwYW5lLnR5cGUgPT09IFwibG9hZGluZ1wiID8gTE9BRElOR19QQU5FIDogcGFuZS5wYW5lTm9kZSxcbiAgICAgICAgICAgIHBhcmFtczogcm91dGVyUGFuZVNpYmxpbmcucGFyYW1zIHx8IHt9LFxuICAgICAgICAgICAgcGF0aDogcGF0aC5qb2luKFwiO1wiKSxcbiAgICAgICAgICAgIHBheWxvYWQ6IHJvdXRlclBhbmVTaWJsaW5nLnBheWxvYWQsXG4gICAgICAgICAgICBzZWxlY3RlZDogZmxhdEluZGV4ID09PSByZXNvbHZlZFBhbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgICBzaWJsaW5nSW5kZXhcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwYW5lRGF0YUl0ZW1zLFxuICAgICAgICAgIHJvdXRlclBhbmVzLFxuICAgICAgICAgIHJlc29sdmVkUGFuZXM6IHBhbmVEYXRhSXRlbXMubWFwKChwYW5lKSA9PiBwYW5lLnBhbmUpXG4gICAgICAgIH07XG4gICAgICB9KVxuICAgICkuc3Vic2NyaWJlKHtcbiAgICAgIG5leHQ6IChyZXN1bHQpID0+IHNldERhdGEocmVzdWx0KSxcbiAgICAgIGVycm9yOiAoZSkgPT4gc2V0RXJyb3IoZSlcbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4gc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gIH0sIFtyb290UGFuZU5vZGUsIHJvdXRlclBhbmVzU3RyZWFtLCBzdHJ1Y3R1cmVDb250ZXh0XSksIGRhdGE7XG59XG5hc3luYyBmdW5jdGlvbiBlbnN1cmVEb2N1bWVudElkQW5kVHlwZShkb2N1bWVudFN0b3JlLCBpZCwgdHlwZSkge1xuICBpZiAoaWQgJiYgdHlwZSkgcmV0dXJuIHsgaWQsIHR5cGUgfTtcbiAgaWYgKCFpZCAmJiB0eXBlKSByZXR1cm4geyBpZDogdXVpZCgpLCB0eXBlIH07XG4gIGlmIChpZCAmJiAhdHlwZSkge1xuICAgIGNvbnN0IHJlc29sdmVkVHlwZSA9IGF3YWl0IGZpcnN0VmFsdWVGcm9tKFxuICAgICAgZG9jdW1lbnRTdG9yZS5yZXNvbHZlVHlwZUZvckRvY3VtZW50KGlkKVxuICAgICk7XG4gICAgcmV0dXJuIHsgaWQsIHR5cGU6IHJlc29sdmVkVHlwZSB9O1xuICB9XG4gIHRocm93IG5ldyBQYW5lUmVzb2x1dGlvbkVycm9yKHtcbiAgICBtZXNzYWdlOiBcIk5laXRoZXIgZG9jdW1lbnQgYGlkYCBvciBgdHlwZWAgd2FzIHByb3ZpZGVkIHdoZW4gdHJ5aW5nIHRvIHJlc29sdmUgaW50ZW50LlwiXG4gIH0pO1xufVxuY29uc3QgRU1QVFlfUkVDT1JEID0ge30sIEludGVudFJlc29sdmVyID0gbWVtbyhmdW5jdGlvbigpIHtcbiAgY29uc3QgeyBuYXZpZ2F0ZSB9ID0gdXNlUm91dGVyKCksIG1heWJlSW50ZW50ID0gdXNlUm91dGVyU3RhdGUoXG4gICAgdXNlQ2FsbGJhY2soKHJvdXRlclN0YXRlKSA9PiB7XG4gICAgICBjb25zdCBpbnRlbnROYW1lID0gdHlwZW9mIHJvdXRlclN0YXRlLmludGVudCA9PSBcInN0cmluZ1wiID8gcm91dGVyU3RhdGUuaW50ZW50IDogdm9pZCAwO1xuICAgICAgcmV0dXJuIGludGVudE5hbWUgPyB7XG4gICAgICAgIGludGVudDogaW50ZW50TmFtZSxcbiAgICAgICAgcGFyYW1zOiBpc1JlY29yZChyb3V0ZXJTdGF0ZS5wYXJhbXMpID8gcm91dGVyU3RhdGUucGFyYW1zIDogRU1QVFlfUkVDT1JELFxuICAgICAgICBwYXlsb2FkOiByb3V0ZXJTdGF0ZS5wYXlsb2FkXG4gICAgICB9IDogdm9pZCAwO1xuICAgIH0sIFtdKVxuICApLCB7IHJvb3RQYW5lTm9kZSwgc3RydWN0dXJlQ29udGV4dCB9ID0gdXNlU3RydWN0dXJlVG9vbCgpLCBkb2N1bWVudFN0b3JlID0gdXNlRG9jdW1lbnRTdG9yZSgpLCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKG51bGwpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICByZXR1cm4gdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAobWF5YmVJbnRlbnQpIHtcbiAgICAgIGNvbnN0IHsgaW50ZW50LCBwYXJhbXMsIHBheWxvYWQgfSA9IG1heWJlSW50ZW50O1xuICAgICAgbGV0IGNhbmNlbGxlZCA9ICExO1xuICAgICAgYXN5bmMgZnVuY3Rpb24gZWZmZWN0KCkge1xuICAgICAgICBjb25zdCB7IGlkLCB0eXBlIH0gPSBhd2FpdCBlbnN1cmVEb2N1bWVudElkQW5kVHlwZShcbiAgICAgICAgICBkb2N1bWVudFN0b3JlLFxuICAgICAgICAgIHR5cGVvZiBwYXJhbXMuaWQgPT0gXCJzdHJpbmdcIiA/IHBhcmFtcy5pZCA6IHZvaWQgMCxcbiAgICAgICAgICB0eXBlb2YgcGFyYW1zLnR5cGUgPT0gXCJzdHJpbmdcIiA/IHBhcmFtcy50eXBlIDogdm9pZCAwXG4gICAgICAgICk7XG4gICAgICAgIGlmIChjYW5jZWxsZWQpIHJldHVybjtcbiAgICAgICAgY29uc3QgcGFuZXMgPSBhd2FpdCByZXNvbHZlSW50ZW50KHtcbiAgICAgICAgICBpbnRlbnQsXG4gICAgICAgICAgcGFyYW1zOiB7IC4uLnBhcmFtcywgaWQsIHR5cGUgfSxcbiAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgIHJvb3RQYW5lTm9kZSxcbiAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgIH0pO1xuICAgICAgICBjYW5jZWxsZWQgfHwgbmF2aWdhdGUoeyBwYW5lcyB9LCB7IHJlcGxhY2U6ICEwIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVmZmVjdCgpLmNhdGNoKHNldEVycm9yKSwgKCkgPT4ge1xuICAgICAgICBjYW5jZWxsZWQgPSAhMDtcbiAgICAgIH07XG4gICAgfVxuICB9LCBbZG9jdW1lbnRTdG9yZSwgbWF5YmVJbnRlbnQsIG5hdmlnYXRlLCByb290UGFuZU5vZGUsIHN0cnVjdHVyZUNvbnRleHRdKSwgbnVsbDtcbn0pLCBQYXRoU2VnbWVudCA9IHN0eWxlZC5zcGFuYFxuICAmOm5vdCg6bGFzdC1jaGlsZCk6OmFmdGVyIHtcbiAgICBjb250ZW50OiAnIOKenSAnO1xuICAgIG9wYWNpdHk6IDAuNTtcbiAgfVxuYDtcbmZ1bmN0aW9uIGZvcm1hdFN0YWNrKHN0YWNrKSB7XG4gIHJldHVybiBzdGFjay5yZXBsYWNlKC9cXChcXC5cXC5cXC5cXClcXC4vZywgYCguLi4pXG4gIC5gKS5yZXBsYWNlKC9fX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFX1xcZCtfKy9nLCBcIlwiKS5yZXBsYWNlKC9fX19kZWZhdWx0XFwuL2csIFwiLlwiKS5yZXBsYWNlKG5ldyBSZWdFeHAoYCBcXFxcKGh0dHBzPzpcXFxcL1xcXFwvJHt3aW5kb3cubG9jYXRpb24uaG9zdH1gLCBcImdcIiksIFwiIChcIik7XG59XG5mdW5jdGlvbiBTdHJ1Y3R1cmVFcnJvcih7IGVycm9yIH0pIHtcbiAgaWYgKCEoZXJyb3IgaW5zdGFuY2VvZiBQYW5lUmVzb2x1dGlvbkVycm9yKSlcbiAgICB0aHJvdyBlcnJvcjtcbiAgY29uc3QgeyBjYXVzZSB9ID0gZXJyb3IsIHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlKSwgc3RhY2sgPSBjYXVzZT8uc3RhY2sgfHwgZXJyb3Iuc3RhY2ssIHNob3dTdGFjayA9IHN0YWNrICYmICEoY2F1c2UgaW5zdGFuY2VvZiBTZXJpYWxpemVFcnJvcikgJiYgIWVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJNb2R1bGUgYnVpbGQgZmFpbGVkOlwiKSwgcGF0aCA9IGNhdXNlIGluc3RhbmNlb2YgU2VyaWFsaXplRXJyb3IgPyBjYXVzZS5wYXRoIDogW10sIGhlbHBJZCA9IGNhdXNlIGluc3RhbmNlb2YgU2VyaWFsaXplRXJyb3IgJiYgY2F1c2UuaGVscElkIHx8IGVycm9yLmhlbHBJZCwgaGFuZGxlUmVsb2FkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgfSwgW10pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChDYXJkLCB7IGhlaWdodDogXCJmaWxsXCIsIG92ZXJmbG93OiBcImF1dG9cIiwgcGFkZGluZzogNCwgc2l6aW5nOiBcImJvcmRlclwiLCB0b25lOiBcImNyaXRpY2FsXCIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhDb250YWluZXIsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KEhlYWRpbmcsIHsgYXM6IFwiaDJcIiwgY2hpbGRyZW46IHQoXCJzdHJ1Y3R1cmUtZXJyb3IuaGVhZGVyLnRleHRcIikgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeHMoQ2FyZCwgeyBtYXJnaW5Ub3A6IDQsIHBhZGRpbmc6IDQsIHJhZGl1czogMiwgb3ZlcmZsb3c6IFwiYXV0b1wiLCBzaGFkb3c6IDEsIHRvbmU6IFwiaW5oZXJpdFwiLCBjaGlsZHJlbjogW1xuICAgICAgcGF0aC5sZW5ndGggPiAwICYmIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFN0YWNrLCB7IHNwYWNlOiAyLCBjaGlsZHJlbjogW1xuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgd2VpZ2h0OiBcIm1lZGl1bVwiLCBjaGlsZHJlbjogdChcInN0cnVjdHVyZS1lcnJvci5zdHJ1Y3R1cmUtcGF0aC5sYWJlbFwiKSB9KSxcbiAgICAgICAgLyogQF9fUFVSRV9fICovIGpzeChDb2RlLCB7IGNoaWxkcmVuOiBwYXRoLnNsaWNlKDEpLm1hcCgoc2VnbWVudCwgaSkgPT4gKFxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9uby1hcnJheS1pbmRleC1rZXlcbiAgICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KFBhdGhTZWdtZW50LCB7IGNoaWxkcmVuOiBzZWdtZW50IH0sIGAke3NlZ21lbnR9LSR7aX1gKVxuICAgICAgICApKSB9KVxuICAgICAgXSB9KSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFN0YWNrLCB7IG1hcmdpblRvcDogNCwgc3BhY2U6IDIsIGNoaWxkcmVuOiBbXG4gICAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiB0KFwic3RydWN0dXJlLWVycm9yLmVycm9yLmxhYmVsXCIpIH0pLFxuICAgICAgICAvKiBAX19QVVJFX18gKi8ganN4KENvZGUsIHsgY2hpbGRyZW46IHNob3dTdGFjayA/IGZvcm1hdFN0YWNrKHN0YWNrKSA6IGVycm9yLm1lc3NhZ2UgfSlcbiAgICAgIF0gfSksXG4gICAgICBoZWxwSWQgJiYgLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgbWFyZ2luVG9wOiA0LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFwiYVwiLCB7IGhyZWY6IGdlbmVyYXRlSGVscFVybChoZWxwSWQpLCByZWw6IFwibm9vcGVuZXIgbm9yZWZlcnJlclwiLCB0YXJnZXQ6IFwiX2JsYW5rXCIsIGNoaWxkcmVuOiB0KFwic3RydWN0dXJlLWVycm9yLmRvY3MtbGluay50ZXh0XCIpIH0pIH0pIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgbWFyZ2luVG9wOiA0LCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgICAgQnV0dG9uLFxuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogdChcInN0cnVjdHVyZS1lcnJvci5yZWxvYWQtYnV0dG9uLnRleHRcIiksXG4gICAgICAgICAgaWNvbjogU3luY0ljb24sXG4gICAgICAgICAgdG9uZTogXCJwcmltYXJ5XCIsXG4gICAgICAgICAgb25DbGljazogaGFuZGxlUmVsb2FkXG4gICAgICAgIH1cbiAgICAgICkgfSlcbiAgICBdIH0pXG4gIF0gfSkgfSk7XG59XG5mdW5jdGlvbiBVbmtub3duUGFuZShwcm9wcykge1xuICBjb25zdCB7IGlzU2VsZWN0ZWQsIHBhbmUsIHBhbmVLZXkgfSA9IHByb3BzLCB0eXBlID0gaXNSZWNvcmQocGFuZSkgJiYgcGFuZS50eXBlIHx8IG51bGwsIHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3hzKFBhbmUsIHsgaWQ6IHBhbmVLZXksIHNlbGVjdGVkOiBpc1NlbGVjdGVkLCBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goUGFuZUhlYWRlciwgeyB0aXRsZTogdChcInBhbmVzLnVua25vd24tcGFuZS10eXBlLnRpdGxlXCIpIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goUGFuZUNvbnRlbnQsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goQm94LCB7IHBhZGRpbmc6IDQsIGNoaWxkcmVuOiB0eXBlb2YgdHlwZSA9PSBcInN0cmluZ1wiID8gLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IGFzOiBcInBcIiwgbXV0ZWQ6ICEwLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIFRyYW5zbGF0ZSxcbiAgICAgIHtcbiAgICAgICAgdCxcbiAgICAgICAgaTE4bktleTogXCJwYW5lcy51bmtub3duLXBhbmUtdHlwZS51bmtub3duLXR5cGUudGV4dFwiLFxuICAgICAgICB2YWx1ZXM6IHsgdHlwZSB9XG4gICAgICB9XG4gICAgKSB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBhczogXCJwXCIsIG11dGVkOiAhMCwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVHJhbnNsYXRlLCB7IHQsIGkxOG5LZXk6IFwicGFuZXMudW5rbm93bi1wYW5lLXR5cGUubWlzc2luZy10eXBlLnRleHRcIiB9KSB9KSB9KSB9KVxuICBdIH0pO1xufVxuY29uc3QgcGFuZU1hcCA9IHtcbiAgY29tcG9uZW50OiBsYXp5KCgpID0+IGltcG9ydChcIi4vaW5kZXgubWpzXCIpKSxcbiAgZG9jdW1lbnQ6IGxhenkoKCkgPT4gaW1wb3J0KFwiLi9wYW5lLm1qc1wiKS50aGVuKGZ1bmN0aW9uKG4pIHtcbiAgICByZXR1cm4gbi5wYW5lO1xuICB9KSksXG4gIGRvY3VtZW50TGlzdDogbGF6eSgoKSA9PiBpbXBvcnQoXCIuL3BhbmUubWpzXCIpLnRoZW4oZnVuY3Rpb24obikge1xuICAgIHJldHVybiBuLnBhbmUkMTtcbiAgfSkpLFxuICBsaXN0OiBsYXp5KCgpID0+IGltcG9ydChcIi4vaW5kZXgyLm1qc1wiKSlcbn0sIFN0cnVjdHVyZVRvb2xQYW5lID0gbWVtbyhcbiAgZnVuY3Rpb24ocHJvcHMpIHtcbiAgICBjb25zdCB7XG4gICAgICBhY3RpdmUsXG4gICAgICBjaGlsZEl0ZW1JZCxcbiAgICAgIGdyb3VwSW5kZXgsXG4gICAgICBpbmRleCxcbiAgICAgIGl0ZW1JZCxcbiAgICAgIHBhbmUsXG4gICAgICBwYW5lS2V5LFxuICAgICAgcGFyYW1zLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIHBhdGgsXG4gICAgICBzZWxlY3RlZCxcbiAgICAgIHNpYmxpbmdJbmRleFxuICAgIH0gPSBwcm9wcywgUGFuZUNvbXBvbmVudCA9IHBhbmVNYXBbcGFuZS50eXBlXSB8fCBVbmtub3duUGFuZTtcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChcbiAgICAgIFBhbmVSb3V0ZXJQcm92aWRlcixcbiAgICAgIHtcbiAgICAgICAgZmxhdEluZGV4OiBpbmRleCxcbiAgICAgICAgaW5kZXg6IGdyb3VwSW5kZXgsXG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgc2libGluZ0luZGV4LFxuICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChTdXNwZW5zZSwgeyBmYWxsYmFjazogLyogQF9fUFVSRV9fICovIGpzeChMb2FkaW5nUGFuZSwgeyBwYW5lS2V5LCBwYXRoLCBzZWxlY3RlZCB9KSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgICAgUGFuZUNvbXBvbmVudCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBjaGlsZEl0ZW1JZDogY2hpbGRJdGVtSWQgfHwgXCJcIixcbiAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgaXRlbUlkLFxuICAgICAgICAgICAgaXNBY3RpdmU6IGFjdGl2ZSxcbiAgICAgICAgICAgIGlzU2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgICAgICAgICAgcGFuZUtleSxcbiAgICAgICAgICAgIHBhbmVcbiAgICAgICAgICB9XG4gICAgICAgICkgfSlcbiAgICAgIH1cbiAgICApO1xuICB9LFxuICAoeyBwYXJhbXM6IHByZXZQYXJhbXMgPSB7fSwgcGF5bG9hZDogcHJldlBheWxvYWQgPSBudWxsLCAuLi5wcmV2IH0sIHsgcGFyYW1zOiBuZXh0UGFyYW1zID0ge30sIHBheWxvYWQ6IG5leHRQYXlsb2FkID0gbnVsbCwgLi4ubmV4dCB9KSA9PiB7XG4gICAgaWYgKCFpc0VxdWFsKHByZXZQYXJhbXMsIG5leHRQYXJhbXMpIHx8ICFpc0VxdWFsKHByZXZQYXlsb2FkLCBuZXh0UGF5bG9hZCkpIHJldHVybiAhMTtcbiAgICBjb25zdCBrZXlzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoWy4uLk9iamVjdC5rZXlzKHByZXYpLCAuLi5PYmplY3Qua2V5cyhuZXh0KV0pO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpXG4gICAgICBpZiAocHJldltrZXldICE9PSBuZXh0W2tleV0pIHJldHVybiAhMTtcbiAgICByZXR1cm4gITA7XG4gIH1cbik7XG5mdW5jdGlvbiBOb0RvY3VtZW50VHlwZXNTY3JlZW4oKSB7XG4gIGNvbnN0IHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQ2FyZCwgeyBoZWlnaHQ6IFwiZmlsbFwiLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChGbGV4LCB7IGFsaWduOiBcImNlbnRlclwiLCBoZWlnaHQ6IFwiZmlsbFwiLCBqdXN0aWZ5OiBcImNlbnRlclwiLCBwYWRkaW5nOiA0LCBzaXppbmc6IFwiYm9yZGVyXCIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KENvbnRhaW5lciwgeyB3aWR0aDogMCwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goQ2FyZCwgeyBwYWRkaW5nOiA0LCByYWRpdXM6IDIsIHNoYWRvdzogMSwgdG9uZTogXCJjYXV0aW9uXCIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhGbGV4LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChXYXJuaW5nT3V0bGluZUljb24sIHt9KSB9KSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4cyhTdGFjaywgeyBmbGV4OiAxLCBtYXJnaW5MZWZ0OiAzLCBzcGFjZTogMywgY2hpbGRyZW46IFtcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBhczogXCJoMVwiLCBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiB0KFwibm8tZG9jdW1lbnQtdHlwZXMtc2NyZWVuLnRpdGxlXCIpIH0pLFxuICAgICAgLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IGFzOiBcInBcIiwgbXV0ZWQ6ICEwLCBzaXplOiAxLCBjaGlsZHJlbjogdChcIm5vLWRvY3VtZW50LXR5cGVzLXNjcmVlbi5zdWJ0aXRsZVwiKSB9KSxcbiAgICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBhczogXCJwXCIsIG11dGVkOiAhMCwgc2l6ZTogMSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goXG4gICAgICAgIFwiYVwiLFxuICAgICAgICB7XG4gICAgICAgICAgaHJlZjogXCJodHRwczovL3d3dy5zYW5pdHkuaW8vZG9jcy9jcmVhdGUtYS1zY2hlbWEtYW5kLWNvbmZpZ3VyZS1zYW5pdHktc3R1ZGlvXCIsXG4gICAgICAgICAgdGFyZ2V0OiBcIl9ibGFua1wiLFxuICAgICAgICAgIHJlbDogXCJub3JlZmVycmVyXCIsXG4gICAgICAgICAgY2hpbGRyZW46IHQoXCJuby1kb2N1bWVudC10eXBlcy1zY3JlZW4ubGluay10ZXh0XCIpXG4gICAgICAgIH1cbiAgICAgICkgfSlcbiAgICBdIH0pXG4gIF0gfSkgfSkgfSkgfSkgfSk7XG59XG5jb25zdCBEb2N1bWVudFRpdGxlID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0IHsgZG9jdW1lbnRJZCwgZG9jdW1lbnRUeXBlIH0gPSBwcm9wcywgZWRpdFN0YXRlID0gdXNlRWRpdFN0YXRlKGRvY3VtZW50SWQsIGRvY3VtZW50VHlwZSksIHNjaGVtYSA9IHVzZVNjaGVtYSgpLCB7IHQgfSA9IHVzZVRyYW5zbGF0aW9uKHN0cnVjdHVyZUxvY2FsZU5hbWVzcGFjZSksIGlzTmV3RG9jdW1lbnQgPSAhZWRpdFN0YXRlPy5wdWJsaXNoZWQgJiYgIWVkaXRTdGF0ZT8uZHJhZnQsIGRvY3VtZW50VmFsdWUgPSBlZGl0U3RhdGU/LmRyYWZ0IHx8IGVkaXRTdGF0ZT8ucHVibGlzaGVkLCBzY2hlbWFUeXBlID0gc2NoZW1hLmdldChkb2N1bWVudFR5cGUpLCB7IHZhbHVlLCBpc0xvYWRpbmc6IHByZXZpZXdWYWx1ZUlzTG9hZGluZyB9ID0gdW5zdGFibGVfdXNlVmFsdWVQcmV2aWV3KHtcbiAgICBlbmFibGVkOiAhMCxcbiAgICBzY2hlbWFUeXBlLFxuICAgIHZhbHVlOiBkb2N1bWVudFZhbHVlXG4gIH0pLCBkb2N1bWVudFRpdGxlID0gaXNOZXdEb2N1bWVudCA/IHQoXCJicm93c2VyLWRvY3VtZW50LXRpdGxlLm5ldy1kb2N1bWVudFwiLCB7XG4gICAgc2NoZW1hVHlwZTogc2NoZW1hVHlwZT8udGl0bGUgfHwgc2NoZW1hVHlwZT8ubmFtZVxuICB9KSA6IHZhbHVlPy50aXRsZSB8fCB0KFwiYnJvd3Nlci1kb2N1bWVudC10aXRsZS51bnRpdGxlZC1kb2N1bWVudFwiKSwgc2V0dGxlZCA9IGVkaXRTdGF0ZS5yZWFkeSAmJiAhcHJldmlld1ZhbHVlSXNMb2FkaW5nLCBuZXdUaXRsZSA9IHVzZUNvbnN0cnVjdERvY3VtZW50VGl0bGUoZG9jdW1lbnRUaXRsZSk7XG4gIHJldHVybiB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHNldHRsZWQgJiYgKGRvY3VtZW50LnRpdGxlID0gbmV3VGl0bGUpO1xuICB9LCBbZG9jdW1lbnRUaXRsZSwgc2V0dGxlZCwgbmV3VGl0bGVdKSwgbnVsbDtcbn0sIFBhc3N0aHJvdWdoVGl0bGUgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgeyB0aXRsZSB9ID0gcHJvcHMsIG5ld1RpdGxlID0gdXNlQ29uc3RydWN0RG9jdW1lbnRUaXRsZSh0aXRsZSk7XG4gIHJldHVybiB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGRvY3VtZW50LnRpdGxlID0gbmV3VGl0bGU7XG4gIH0sIFtuZXdUaXRsZSwgdGl0bGVdKSwgbnVsbDtcbn0sIFN0cnVjdHVyZVRpdGxlID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0IHsgcmVzb2x2ZWRQYW5lcyB9ID0gcHJvcHM7XG4gIGlmICghcmVzb2x2ZWRQYW5lcz8ubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgbGFzdFBhbmUgPSByZXNvbHZlZFBhbmVzW3Jlc29sdmVkUGFuZXMubGVuZ3RoIC0gMV07XG4gIHJldHVybiBpc0xvYWRpbmdQYW5lKGxhc3RQYW5lKSA/IC8qIEBfX1BVUkVfXyAqLyBqc3goUGFzc3Rocm91Z2hUaXRsZSwge30pIDogaXNEb2N1bWVudFBhbmUobGFzdFBhbmUpID8gbGFzdFBhbmU/LnRpdGxlID8gLyogQF9fUFVSRV9fICovIGpzeChQYXNzdGhyb3VnaFRpdGxlLCB7IHRpdGxlOiBsYXN0UGFuZS50aXRsZSB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goRG9jdW1lbnRUaXRsZSwgeyBkb2N1bWVudElkOiBsYXN0UGFuZS5vcHRpb25zLmlkLCBkb2N1bWVudFR5cGU6IGxhc3RQYW5lLm9wdGlvbnMudHlwZSB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goUGFzc3Rocm91Z2hUaXRsZSwgeyB0aXRsZTogbGFzdFBhbmU/LnRpdGxlIH0pO1xufTtcbmZ1bmN0aW9uIHVzZUNvbnN0cnVjdERvY3VtZW50VGl0bGUoYWN0aXZlVGl0bGUpIHtcbiAgY29uc3Qgc3RydWN0dXJlVG9vbEJhc2VUaXRsZSA9IHVzZVN0cnVjdHVyZVRvb2woKS5zdHJ1Y3R1cmVDb250ZXh0LnRpdGxlO1xuICByZXR1cm4gW2FjdGl2ZVRpdGxlLCBzdHJ1Y3R1cmVUb29sQmFzZVRpdGxlXS5maWx0ZXIoKHRpdGxlKSA9PiB0aXRsZSkuam9pbihcIiB8IFwiKTtcbn1cbmZ1bmN0aW9uIGlzRG9jdW1lbnRQYW5lKHBhbmUpIHtcbiAgcmV0dXJuIHBhbmUgIT09IExPQURJTkdfUEFORSAmJiBwYW5lLnR5cGUgPT09IFwiZG9jdW1lbnRcIjtcbn1cbmZ1bmN0aW9uIGlzTG9hZGluZ1BhbmUocGFuZSkge1xuICByZXR1cm4gcGFuZSA9PT0gTE9BRElOR19QQU5FO1xufVxuY29uc3QgU3R5bGVkUGFuZUxheW91dCA9IHN0eWxlZChQYW5lTGF5b3V0KWBcbiAgbWluLWhlaWdodDogMTAwJTtcbiAgbWluLXdpZHRoOiAzMjBweDtcbmAsIGlzU2F2ZUhvdGtleSA9IGlzSG90a2V5KFwibW9kK3NcIiksIFN0cnVjdHVyZVRvb2wgPSBtZW1vKGZ1bmN0aW9uKHsgb25QYW5lQ2hhbmdlIH0pIHtcbiAgY29uc3QgeyBwdXNoOiBwdXNoVG9hc3QgfSA9IHVzZVRvYXN0KCksIHNjaGVtYSA9IHVzZVNjaGVtYSgpLCB7IGxheW91dENvbGxhcHNlZCwgc2V0TGF5b3V0Q29sbGFwc2VkIH0gPSB1c2VTdHJ1Y3R1cmVUb29sKCksIHsgcGFuZURhdGFJdGVtcywgcmVzb2x2ZWRQYW5lcyB9ID0gdXNlUmVzb2x2ZWRQYW5lcygpLCBpc1Jlc29sdmluZ0ludGVudCA9IHVzZVJvdXRlclN0YXRlKFxuICAgIHVzZUNhbGxiYWNrKChyb3V0ZXJTdGF0ZSkgPT4gdHlwZW9mIHJvdXRlclN0YXRlLmludGVudCA9PSBcInN0cmluZ1wiLCBbXSlcbiAgKSwge1xuICAgIHNhbml0eTogeyBtZWRpYSB9XG4gIH0gPSB1c2VUaGVtZSgpLCBbcG9ydGFsRWxlbWVudCwgc2V0UG9ydGFsRWxlbWVudF0gPSB1c2VTdGF0ZShudWxsKSwgaGFuZGxlUm9vdENvbGxhcHNlID0gdXNlQ2FsbGJhY2soKCkgPT4gc2V0TGF5b3V0Q29sbGFwc2VkKCEwKSwgW3NldExheW91dENvbGxhcHNlZF0pLCBoYW5kbGVSb290RXhwYW5kID0gdXNlQ2FsbGJhY2soKCkgPT4gc2V0TGF5b3V0Q29sbGFwc2VkKCExKSwgW3NldExheW91dENvbGxhcHNlZF0pO1xuICByZXR1cm4gdXNlRWZmZWN0KCgpID0+IHtcbiAgICByZXNvbHZlZFBhbmVzLmxlbmd0aCAmJiBvblBhbmVDaGFuZ2UocmVzb2x2ZWRQYW5lcyk7XG4gIH0sIFtvblBhbmVDaGFuZ2UsIHJlc29sdmVkUGFuZXNdKSwgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVHbG9iYWxLZXlEb3duID0gKGV2ZW50KSA9PiB7XG4gICAgICBpc1NhdmVIb3RrZXkoZXZlbnQpICYmIChldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBwdXNoVG9hc3Qoe1xuICAgICAgICBjbG9zYWJsZTogITAsXG4gICAgICAgIGlkOiBcImF1dG8tc2F2ZS1tZXNzYWdlXCIsXG4gICAgICAgIHN0YXR1czogXCJpbmZvXCIsXG4gICAgICAgIHRpdGxlOiBcIllvdXIgd29yayBpcyBhdXRvbWF0aWNhbGx5IHNhdmVkIVwiLFxuICAgICAgICBkdXJhdGlvbjogNGUzXG4gICAgICB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUdsb2JhbEtleURvd24pLCAoKSA9PiB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlR2xvYmFsS2V5RG93bik7XG4gIH0sIFtwdXNoVG9hc3RdKSwgc2NoZW1hLl9vcmlnaW5hbD8udHlwZXMuc29tZShfaXNDdXN0b21Eb2N1bWVudFR5cGVEZWZpbml0aW9uKSA/IC8qIEBfX1BVUkVfXyAqLyBqc3hzKFBvcnRhbFByb3ZpZGVyLCB7IGVsZW1lbnQ6IHBvcnRhbEVsZW1lbnQgfHwgbnVsbCwgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4cyhcbiAgICAgIFN0eWxlZFBhbmVMYXlvdXQsXG4gICAgICB7XG4gICAgICAgIGZsZXg6IDEsXG4gICAgICAgIGhlaWdodDogbGF5b3V0Q29sbGFwc2VkID8gdm9pZCAwIDogXCJmaWxsXCIsXG4gICAgICAgIG1pbldpZHRoOiBtZWRpYVsxXSxcbiAgICAgICAgb25Db2xsYXBzZTogaGFuZGxlUm9vdENvbGxhcHNlLFxuICAgICAgICBvbkV4cGFuZDogaGFuZGxlUm9vdEV4cGFuZCxcbiAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICBwYW5lRGF0YUl0ZW1zLm1hcChcbiAgICAgICAgICAgICh7XG4gICAgICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICAgICAgY2hpbGRJdGVtSWQsXG4gICAgICAgICAgICAgIGdyb3VwSW5kZXgsXG4gICAgICAgICAgICAgIGl0ZW1JZCxcbiAgICAgICAgICAgICAga2V5OiBwYW5lS2V5LFxuICAgICAgICAgICAgICBwYW5lLFxuICAgICAgICAgICAgICBpbmRleDogcGFuZUluZGV4LFxuICAgICAgICAgICAgICBwYXJhbXM6IHBhbmVQYXJhbXMsXG4gICAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICAgIHBheWxvYWQsXG4gICAgICAgICAgICAgIHNpYmxpbmdJbmRleCxcbiAgICAgICAgICAgICAgc2VsZWN0ZWRcbiAgICAgICAgICAgIH0pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IHBhbmUgPT09IExPQURJTkdfUEFORSA/IC8qIEBfX1BVUkVfXyAqLyBqc3goTG9hZGluZ1BhbmUsIHsgcGFuZUtleSwgcGF0aCwgc2VsZWN0ZWQgfSkgOiAvKiBAX19QVVJFX18gKi8ganN4KFxuICAgICAgICAgICAgICBTdHJ1Y3R1cmVUb29sUGFuZSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICAgICAgICBncm91cEluZGV4LFxuICAgICAgICAgICAgICAgIGluZGV4OiBwYW5lSW5kZXgsXG4gICAgICAgICAgICAgICAgcGFuZSxcbiAgICAgICAgICAgICAgICBjaGlsZEl0ZW1JZCxcbiAgICAgICAgICAgICAgICBpdGVtSWQsXG4gICAgICAgICAgICAgICAgcGFuZUtleSxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhbmVQYXJhbXMsXG4gICAgICAgICAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkLFxuICAgICAgICAgICAgICAgIHNpYmxpbmdJbmRleFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApIH0sIGAke3BhbmUgPT09IExPQURJTkdfUEFORSA/IFwibG9hZGluZ1wiIDogcGFuZS50eXBlfS0ke3BhbmVJbmRleH1gKVxuICAgICAgICAgICksXG4gICAgICAgICAgcGFuZURhdGFJdGVtcy5sZW5ndGggPD0gMSAmJiBpc1Jlc29sdmluZ0ludGVudCAmJiAvKiBAX19QVVJFX18gKi8ganN4KExvYWRpbmdQYW5lLCB7IHBhbmVLZXk6IFwiaW50ZW50LXJlc29sdmVyXCIgfSlcbiAgICAgICAgXVxuICAgICAgfVxuICAgICksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChTdHJ1Y3R1cmVUaXRsZSwgeyByZXNvbHZlZFBhbmVzIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBcImRhdGEtcG9ydGFsXCI6IFwiXCIsIHJlZjogc2V0UG9ydGFsRWxlbWVudCB9KVxuICBdIH0pIDogLyogQF9fUFVSRV9fICovIGpzeChOb0RvY3VtZW50VHlwZXNTY3JlZW4sIHt9KTtcbn0pO1xuZnVuY3Rpb24gU3RydWN0dXJlVG9vbEJvdW5kYXJ5KHsgdG9vbDogeyBvcHRpb25zIH0gfSkge1xuICBjb25zdCB7IHVuc3RhYmxlX3NvdXJjZXM6IHNvdXJjZXMgfSA9IHVzZVdvcmtzcGFjZSgpLCBbZmlyc3RTb3VyY2VdID0gc291cmNlcywgeyBzb3VyY2UsIGRlZmF1bHREb2N1bWVudE5vZGUsIHN0cnVjdHVyZSB9ID0gb3B0aW9ucyB8fCB7fTtcbiAgdXNlRWZmZWN0KCgpID0+IChzZXRBY3RpdmVQYW5lcyhbXSksICgpID0+IHNldEFjdGl2ZVBhbmVzKFtdKSksIFtdKTtcbiAgY29uc3QgW3sgZXJyb3IgfSwgc2V0RXJyb3JdID0gdXNlU3RhdGUoeyBlcnJvcjogbnVsbCB9KTtcbiAgcmV0dXJuIGVycm9yID8gLyogQF9fUFVSRV9fICovIGpzeChTdHJ1Y3R1cmVFcnJvciwgeyBlcnJvciB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goRXJyb3JCb3VuZGFyeSwgeyBvbkNhdGNoOiBzZXRFcnJvciwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goU291cmNlUHJvdmlkZXIsIHsgbmFtZTogc291cmNlIHx8IGZpcnN0U291cmNlLm5hbWUsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhTdHJ1Y3R1cmVUb29sUHJvdmlkZXIsIHsgZGVmYXVsdERvY3VtZW50Tm9kZSwgc3RydWN0dXJlLCBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RydWN0dXJlVG9vbCwgeyBvblBhbmVDaGFuZ2U6IHNldEFjdGl2ZVBhbmVzIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goSW50ZW50UmVzb2x2ZXIsIHt9KVxuICBdIH0pIH0pIH0pO1xufVxuZXhwb3J0IHtcbiAgU3RydWN0dXJlVG9vbEJvdW5kYXJ5IGFzIGRlZmF1bHRcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleDMubWpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/sanity/lib/_chunks-es/index3.mjs\n"));

/***/ })

}]);